\documentclass[11pt]{article}

    \usepackage[breakable]{tcolorbox}
    \usepackage{parskip} % Stop auto-indenting (to mimic markdown behaviour)
    
    \usepackage{iftex}
    \ifPDFTeX
    	\usepackage[T1]{fontenc}
    	\usepackage{mathpazo}
    \else
    	\usepackage{fontspec}
    \fi

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % Maintain compatibility with old templates. Remove in nbconvert 6.0
    \let\Oldincludegraphics\includegraphics
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionFormat{nocaption}{}
    \captionsetup{format=nocaption,aboveskip=0pt,belowskip=0pt}

    \usepackage{float}
    \floatplacement{figure}{H} % forces figures to be placed at the correct location
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range
    \makeatletter % fix for old versions of grffile with XeLaTeX
    \@ifpackagelater{grffile}{2019/11/01}
    {
      % Do nothing on new versions
    }
    {
      \def\Gread@@xetex#1{%
        \IfFileExists{"\Gin@base".bb}%
        {\Gread@eps{\Gin@base.bb}}%
        {\Gread@@xetex@aux#1}%
      }
    }
    \makeatother
    \usepackage[Export]{adjustbox} % Used to constrain images to a maximum size
    \adjustboxset{max size={0.9\linewidth}{0.9\paperheight}}

    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    % The default LaTeX title has an obnoxious amount of whitespace. By default,
    % titling removes some of it. It also provides customization options.
    \usepackage{titling}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    \usepackage{mathrsfs}
    

    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}
    \definecolor{ansi-default-inverse-fg}{HTML}{FFFFFF}
    \definecolor{ansi-default-inverse-bg}{HTML}{000000}

    % common color for the border for error outputs.
    \definecolor{outerrorbackground}{HTML}{FFDFDF}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatibility definitions
    \def\gt{>}
    \def\lt{<}
    \let\Oldtex\TeX
    \let\Oldlatex\LaTeX
    \renewcommand{\TeX}{\textrm{\Oldtex}}
    \renewcommand{\LaTeX}{\textrm{\Oldlatex}}
    % Document parameters
    % Document title
    \title{process}
    
    
    
    
    
% Pygments definitions
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\@namedef{PY@tok@w}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\@namedef{PY@tok@c}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\@namedef{PY@tok@cp}{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\@namedef{PY@tok@k}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kp}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kt}{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\@namedef{PY@tok@o}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@ow}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\@namedef{PY@tok@nb}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@nf}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@nc}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@nn}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@ne}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\@namedef{PY@tok@nv}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@no}{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\@namedef{PY@tok@nl}{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\@namedef{PY@tok@ni}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\@namedef{PY@tok@na}{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\@namedef{PY@tok@nt}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@nd}{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\@namedef{PY@tok@s}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sd}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@si}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\@namedef{PY@tok@se}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\@namedef{PY@tok@sr}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\@namedef{PY@tok@ss}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@sx}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@m}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@gh}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\@namedef{PY@tok@gu}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\@namedef{PY@tok@gd}{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\@namedef{PY@tok@gi}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\@namedef{PY@tok@gr}{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\@namedef{PY@tok@ge}{\let\PY@it=\textit}
\@namedef{PY@tok@gs}{\let\PY@bf=\textbf}
\@namedef{PY@tok@gp}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\@namedef{PY@tok@go}{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\@namedef{PY@tok@gt}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\@namedef{PY@tok@err}{\def\PY@bc##1{{\setlength{\fboxsep}{\string -\fboxrule}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}}
\@namedef{PY@tok@kc}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kd}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kn}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kr}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@bp}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@fm}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@vc}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vg}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vi}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vm}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@sa}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sb}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sc}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@dl}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@s2}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sh}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@s1}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@mb}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mf}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mh}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mi}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@il}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mo}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@ch}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\@namedef{PY@tok@cm}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\@namedef{PY@tok@cpf}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\@namedef{PY@tok@c1}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\@namedef{PY@tok@cs}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % For linebreaks inside Verbatim environment from package fancyvrb. 
    \makeatletter
        \newbox\Wrappedcontinuationbox 
        \newbox\Wrappedvisiblespacebox 
        \newcommand*\Wrappedvisiblespace {\textcolor{red}{\textvisiblespace}} 
        \newcommand*\Wrappedcontinuationsymbol {\textcolor{red}{\llap{\tiny$\m@th\hookrightarrow$}}} 
        \newcommand*\Wrappedcontinuationindent {3ex } 
        \newcommand*\Wrappedafterbreak {\kern\Wrappedcontinuationindent\copy\Wrappedcontinuationbox} 
        % Take advantage of the already applied Pygments mark-up to insert 
        % potential linebreaks for TeX processing. 
        %        {, <, #, %, $, ' and ": go to next line. 
        %        _, }, ^, &, >, - and ~: stay at end of broken line. 
        % Use of \textquotesingle for straight quote. 
        \newcommand*\Wrappedbreaksatspecials {% 
            \def\PYGZus{\discretionary{\char`\_}{\Wrappedafterbreak}{\char`\_}}% 
            \def\PYGZob{\discretionary{}{\Wrappedafterbreak\char`\{}{\char`\{}}% 
            \def\PYGZcb{\discretionary{\char`\}}{\Wrappedafterbreak}{\char`\}}}% 
            \def\PYGZca{\discretionary{\char`\^}{\Wrappedafterbreak}{\char`\^}}% 
            \def\PYGZam{\discretionary{\char`\&}{\Wrappedafterbreak}{\char`\&}}% 
            \def\PYGZlt{\discretionary{}{\Wrappedafterbreak\char`\<}{\char`\<}}% 
            \def\PYGZgt{\discretionary{\char`\>}{\Wrappedafterbreak}{\char`\>}}% 
            \def\PYGZsh{\discretionary{}{\Wrappedafterbreak\char`\#}{\char`\#}}% 
            \def\PYGZpc{\discretionary{}{\Wrappedafterbreak\char`\%}{\char`\%}}% 
            \def\PYGZdl{\discretionary{}{\Wrappedafterbreak\char`\$}{\char`\$}}% 
            \def\PYGZhy{\discretionary{\char`\-}{\Wrappedafterbreak}{\char`\-}}% 
            \def\PYGZsq{\discretionary{}{\Wrappedafterbreak\textquotesingle}{\textquotesingle}}% 
            \def\PYGZdq{\discretionary{}{\Wrappedafterbreak\char`\"}{\char`\"}}% 
            \def\PYGZti{\discretionary{\char`\~}{\Wrappedafterbreak}{\char`\~}}% 
        } 
        % Some characters . , ; ? ! / are not pygmentized. 
        % This macro makes them "active" and they will insert potential linebreaks 
        \newcommand*\Wrappedbreaksatpunct {% 
            \lccode`\~`\.\lowercase{\def~}{\discretionary{\hbox{\char`\.}}{\Wrappedafterbreak}{\hbox{\char`\.}}}% 
            \lccode`\~`\,\lowercase{\def~}{\discretionary{\hbox{\char`\,}}{\Wrappedafterbreak}{\hbox{\char`\,}}}% 
            \lccode`\~`\;\lowercase{\def~}{\discretionary{\hbox{\char`\;}}{\Wrappedafterbreak}{\hbox{\char`\;}}}% 
            \lccode`\~`\:\lowercase{\def~}{\discretionary{\hbox{\char`\:}}{\Wrappedafterbreak}{\hbox{\char`\:}}}% 
            \lccode`\~`\?\lowercase{\def~}{\discretionary{\hbox{\char`\?}}{\Wrappedafterbreak}{\hbox{\char`\?}}}% 
            \lccode`\~`\!\lowercase{\def~}{\discretionary{\hbox{\char`\!}}{\Wrappedafterbreak}{\hbox{\char`\!}}}% 
            \lccode`\~`\/\lowercase{\def~}{\discretionary{\hbox{\char`\/}}{\Wrappedafterbreak}{\hbox{\char`\/}}}% 
            \catcode`\.\active
            \catcode`\,\active 
            \catcode`\;\active
            \catcode`\:\active
            \catcode`\?\active
            \catcode`\!\active
            \catcode`\/\active 
            \lccode`\~`\~ 	
        }
    \makeatother

    \let\OriginalVerbatim=\Verbatim
    \makeatletter
    \renewcommand{\Verbatim}[1][1]{%
        %\parskip\z@skip
        \sbox\Wrappedcontinuationbox {\Wrappedcontinuationsymbol}%
        \sbox\Wrappedvisiblespacebox {\FV@SetupFont\Wrappedvisiblespace}%
        \def\FancyVerbFormatLine ##1{\hsize\linewidth
            \vtop{\raggedright\hyphenpenalty\z@\exhyphenpenalty\z@
                \doublehyphendemerits\z@\finalhyphendemerits\z@
                \strut ##1\strut}%
        }%
        % If the linebreak is at a space, the latter will be displayed as visible
        % space at end of first line, and a continuation symbol starts next line.
        % Stretch/shrink are however usually zero for typewriter font.
        \def\FV@Space {%
            \nobreak\hskip\z@ plus\fontdimen3\font minus\fontdimen4\font
            \discretionary{\copy\Wrappedvisiblespacebox}{\Wrappedafterbreak}
            {\kern\fontdimen2\font}%
        }%
        
        % Allow breaks at special characters using \PYG... macros.
        \Wrappedbreaksatspecials
        % Breaks at punctuation characters . , ; ? ! and / need catcode=\active 	
        \OriginalVerbatim[#1,codes*=\Wrappedbreaksatpunct]%
    }
    \makeatother

    % Exact colors from NB
    \definecolor{incolor}{HTML}{303F9F}
    \definecolor{outcolor}{HTML}{D84315}
    \definecolor{cellborder}{HTML}{CFCFCF}
    \definecolor{cellbackground}{HTML}{F7F7F7}
    
    % prompt
    \makeatletter
    \newcommand{\boxspacing}{\kern\kvtcb@left@rule\kern\kvtcb@boxsep}
    \makeatother
    \newcommand{\prompt}[4]{
        {\ttfamily\llap{{\color{#2}[#3]:\hspace{3pt}#4}}\vspace{-\baselineskip}}
    }
    

    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

\begin{document}
    
    \maketitle
    
    

    
    \#\textbf{read the csv file as dataframe}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{1}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}

\PY{n}{df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/Users/wlk/Desktop/3.Semester/CSS/CSIS/nodes}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{df}\PY{o}{=}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{specialty;}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{city}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{;}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{patients}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{;}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{free\PYZus{}time}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{;}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{community}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{;}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{friends}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{;}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{adoption\PYZus{}date}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{;}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{proximity}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{;}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{med\PYZus{}sch\PYZus{}yr}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{;}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{jours}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{;}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{clubs}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{;}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{meetings}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{;}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{id}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{;}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{discuss}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{str}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{;}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{expand}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}

\PY{c+c1}{\PYZsh{} df[6] == df[\PYZdq{}\PYZdq{}adoption\PYZus{}date\PYZdq{}\PYZdq{}]}
\PY{n}{df}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{1}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
   0            1    2    3    4    5     6    7    8    9    10   11     12  \textbackslash{}
0   9  "Galesburg"  "9"  "9"  "9"  "9"  "99"  "9"  "9"  "9"  "9"  "9"  "246"
1   9  "Galesburg"  "9"  "9"  "9"  "9"  "99"  "9"  "9"  "9"  "9"  "9"  "245"
2   9  "Galesburg"  "9"  "9"  "9"  "9"  "99"  "9"  "9"  "9"  "9"  "9"  "244"
3   4  "Galesburg"  "2"  "1"  "4"  "3"  "98"  "2"  "4"  "4"  "0"  "2"  "243"
4   4  "Galesburg"  "9"  "1"  "5"  "3"  "98"  "2"  "4"  "5"  "0"  "1"  "242"
5   1  "Galesburg"  "9"  "9"  "6"  "9"  "16"  "3"  "2"  "4"  "9"  "1"  "241"
6   4  "Galesburg"  "3"  "1"  "6"  "1"  "98"  "3"  "3"  "9"  "1"  "2"  "240"
7   4  "Galesburg"  "2"  "3"  "6"  "2"  "98"  "3"  "1"  "5"  "0"  "2"  "239"
8   4  "Galesburg"  "3"  "1"  "4"  "3"  "98"  "3"  "2"  "6"  "0"  "2"  "238"
9   4  "Galesburg"  "3"  "1"  "4"  "1"  "98"  "3"  "4"  "4"  "1"  "2"  "237"
10  4  "Galesburg"  "9"  "1"  "4"  "2"  "98"  "3"  "5"  "4"  "0"  "2"  "236"
11  4  "Galesburg"  "5"  "1"  "5"  "1"  "98"  "3"  "3"  "7"  "0"  "2"  "235"
12  4  "Galesburg"  "2"  "1"  "4"  "3"  "98"  "2"  "3"  "3"  "0"  "2"  "234"
13  4  "Galesburg"  "6"  "3"  "3"  "4"  "98"  "3"  "5"  "4"  "1"  "2"  "233"
14  4  "Galesburg"  "6"  "3"  "3"  "3"  "98"  "3"  "5"  "5"  "1"  "2"  "232"
15  4  "Galesburg"  "9"  "1"  "5"  "2"  "98"  "3"  "2"  "8"  "0"  "2"  "231"
16  4  "Galesburg"  "3"  "3"  "4"  "4"  "98"  "3"  "4"  "7"  "1"  "1"  "230"
17  3  "Galesburg"  "4"  "1"  "4"  "1"   "7"  "3"  "5"  "4"  "0"  "2"  "229"
18  1  "Galesburg"  "5"  "2"  "6"  "3"  "98"  "1"  "1"  "2"  "0"  "2"  "228"
19  3  "Galesburg"  "9"  "2"  "1"  "4"  "14"  "3"  "6"  "6"  "0"  "1"  "227"

     13
0   "9"
1   "9"
2   "9"
3   "1"
4   "2"
5   "9"
6   "1"
7   "2"
8   "1"
9   "2"
10  "1"
11  "1"
12  "2"
13  "1"
14  "2"
15  "1"
16  "1"
17  "2"
18  "1"
19  "2"
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{2}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{num\PYZus{}agents} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{num\PYZus{}agents}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
246
    \end{Verbatim}

    \hypertarget{rearrange-connections-into-clusters}{%
\section{\texorpdfstring{\textbf{rearrange connections into
clusters}}{rearrange connections into clusters}}\label{rearrange-connections-into-clusters}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{3}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{csv}

\PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}


\PY{n}{max\PYZus{}node\PYZus{}array}\PY{o}{=} \PY{p}{[}\PY{l+m+mi}{116}\PY{p}{,} \PY{l+m+mi}{166}\PY{p}{,} \PY{l+m+mi}{210}\PY{p}{,} \PY{l+m+mi}{246}\PY{p}{]}
\PY{n}{cluster\PYZus{}range} \PY{o}{=} \PY{p}{[}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{116}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{l+m+mi}{116}\PY{p}{,}\PY{l+m+mi}{166}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{l+m+mi}{166}\PY{p}{,}\PY{l+m+mi}{210}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{l+m+mi}{210}\PY{p}{,}\PY{l+m+mi}{246}\PY{p}{]}\PY{p}{]}
\PY{n}{cluster\PYZus{}size} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{116}\PY{p}{,}\PY{l+m+mi}{50}\PY{p}{,}\PY{l+m+mi}{44}\PY{p}{,}\PY{l+m+mi}{36}\PY{p}{]}

\PY{n}{cluster\PYZus{}names} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Peoria}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Bloomington}\PY{l+s+s2}{\PYZdq{}} \PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Quincy}\PY{l+s+s2}{\PYZdq{}} \PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Galesburg}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}



\PY{k}{def} \PY{n+nf}{get\PYZus{}edges\PYZus{}array}\PY{p}{(}\PY{n}{cluster\PYZus{}max}\PY{p}{)}\PY{p}{:}

    \PY{n}{peoria\PYZus{}cluster\PYZus{}edges} \PY{o}{=} \PY{p}{[}\PY{p}{]}

    \PY{n}{bloomington\PYZus{}cluster\PYZus{}edges} \PY{o}{=} \PY{p}{[}\PY{p}{]}

    \PY{n}{quincy\PYZus{}cluster\PYZus{}edges} \PY{o}{=} \PY{p}{[}\PY{p}{]}

    \PY{n}{galesburg\PYZus{}cluster\PYZus{}edges} \PY{o}{=} \PY{p}{[}\PY{p}{]}

    \PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/Users/wlk/Desktop/3.Semester/CSS/CSIS/medical\PYZus{}innovationver3.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{newline}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{encoding}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{utf\PYZhy{}8}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{as} \PY{n}{f}\PY{p}{:}

        \PY{n}{reader} \PY{o}{=} \PY{n}{csv}\PY{o}{.}\PY{n}{reader}\PY{p}{(}\PY{n}{f}\PY{p}{)}

        \PY{n}{row\PYZus{}num} \PY{o}{=} \PY{l+m+mi}{0}

        \PY{k}{for} \PY{n}{row} \PY{o+ow}{in} \PY{n}{reader}\PY{p}{:}
            \PY{k}{if} \PY{n}{row\PYZus{}num} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
                \PY{n}{row\PYZus{}num}\PY{o}{+}\PY{o}{=}\PY{l+m+mi}{1}
            \PY{k}{else}\PY{p}{:}
                \PY{n}{edge\PYZus{}properties} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                \PY{n}{args} \PY{o}{=} \PY{n}{row}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{;}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

                \PY{n}{node1} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n}{args}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}

                

                \PY{n}{node2} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n}{args}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}

                \PY{n}{fr\PYZus{}ad\PYZus{}dis} \PY{o}{=} \PY{p}{[}\PY{n+nb}{int}\PY{p}{(}\PY{n}{args}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n+nb}{int}\PY{p}{(}\PY{n}{args}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n+nb}{int}\PY{p}{(}\PY{n}{args}\PY{p}{[}\PY{l+m+mi}{5}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{]}

                \PY{n+nb}{id} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n}{args}\PY{p}{[}\PY{l+m+mi}{4}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}

                \PY{n}{edge\PYZus{}properties}\PY{o}{=} \PY{p}{[}\PY{n}{node1}\PY{p}{,} \PY{n}{node2}\PY{p}{,} \PY{n}{fr\PYZus{}ad\PYZus{}dis}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{fr\PYZus{}ad\PYZus{}dis}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{fr\PYZus{}ad\PYZus{}dis}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{]}

                \PY{k}{if} \PY{p}{(}\PY{n}{node1} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{n}{cluster\PYZus{}max}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o+ow}{and} \PY{n}{node2} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{n}{cluster\PYZus{}max}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{:}

                    

                    \PY{n}{peoria\PYZus{}cluster\PYZus{}edges}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{edge\PYZus{}properties}\PY{p}{)}

                \PY{k}{elif}\PY{p}{(}\PY{n}{node1} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{n}{cluster\PYZus{}max}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o+ow}{and} \PY{n}{node2} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{n}{cluster\PYZus{}max}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{:} 

                    \PY{n}{bloomington\PYZus{}cluster\PYZus{}edges}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{edge\PYZus{}properties}\PY{p}{)}

                \PY{k}{elif}\PY{p}{(}\PY{n}{node1} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{n}{cluster\PYZus{}max}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]} \PY{o+ow}{and} \PY{n}{node2} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{n}{cluster\PYZus{}max}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{)}\PY{p}{:} 

                    \PY{n}{quincy\PYZus{}cluster\PYZus{}edges}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{edge\PYZus{}properties}\PY{p}{)}

                \PY{k}{else}\PY{p}{:} 

                    \PY{n}{galesburg\PYZus{}cluster\PYZus{}edges}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{edge\PYZus{}properties}\PY{p}{)}

    \PY{k}{return} \PY{n}{peoria\PYZus{}cluster\PYZus{}edges}\PY{p}{,} \PY{n}{bloomington\PYZus{}cluster\PYZus{}edges}\PY{p}{,} \PY{n}{quincy\PYZus{}cluster\PYZus{}edges}\PY{p}{,} \PY{n}{galesburg\PYZus{}cluster\PYZus{}edges}    



\PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}}

\PY{c+c1}{\PYZsh{} edges arrays arguments: }

\PY{c+c1}{\PYZsh{}   \PYZhy{} node1 (from)}

\PY{c+c1}{\PYZsh{}   \PYZhy{} node2 (to) }

\PY{c+c1}{\PYZsh{}   \PYZhy{} friendship relation }

\PY{c+c1}{\PYZsh{}   \PYZhy{} advice relation}

\PY{c+c1}{\PYZsh{}   \PYZhy{} discussion relation}

\PY{c+c1}{\PYZsh{}  \PYZsh{}\PYZsh{}\PYZsh{}}

\PY{n}{peoria\PYZus{}edges}\PY{p}{,} \PY{n}{bloomington\PYZus{}edges}\PY{p}{,} \PY{n}{quincy\PYZus{}edges}\PY{p}{,} \PY{n}{galesburg\PYZus{}edges} \PY{o}{=} \PY{n}{get\PYZus{}edges\PYZus{}array}\PY{p}{(}\PY{n}{max\PYZus{}node\PYZus{}array}\PY{p}{)}
\PY{n}{edge\PYZus{}properties}\PY{o}{=}\PY{p}{[}\PY{p}{]}
\PY{n}{edge\PYZus{}properties}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{peoria\PYZus{}edges}\PY{p}{)}
\PY{n}{edge\PYZus{}properties}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{bloomington\PYZus{}edges}\PY{p}{)}
\PY{n}{edge\PYZus{}properties}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{quincy\PYZus{}edges}\PY{p}{)}
\PY{n}{edge\PYZus{}properties}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{galesburg\PYZus{}edges}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{get-time-revolution-of-opinion-status-of-an-agent-with-original-data}{%
\section{\texorpdfstring{\textbf{get time revolution (of opinion status
of an agent) with original
data}}{get time revolution (of opinion status of an agent) with original data}}\label{get-time-revolution-of-opinion-status-of-an-agent-with-original-data}}

    \begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  each row represents an agent
\item
  each column represents the agent's opinion at this timepoint
\end{enumerate}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{4}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{ad\PYZus{}time\PYZus{}all\PYZus{}old} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+m+mi}{6}\PY{p}{]}
\PY{n}{ad\PYZus{}time\PYZus{}all}\PY{o}{=}\PY{p}{[}\PY{p}{]}
\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{246}\PY{p}{)}\PY{p}{:}
  \PY{n}{ad\PYZus{}time\PYZus{}all}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n+nb}{int}\PY{p}{(}\PY{n}{ad\PYZus{}time\PYZus{}all\PYZus{}old}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{ad\PYZus{}time\PYZus{}all}\PY{p}{)}
\PY{n}{ad\PYZus{}time\PYZus{}all}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{asarray}\PY{p}{(}\PY{n}{ad\PYZus{}time\PYZus{}all}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
[99, 99, 99, 98, 98, 16, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 7, 98, 14,
4, 7, 14, 6, 3, 6, 13, 8, 3, 4, 8, 5, 4, 18, 18, 99, 99, 99, 99, 99, 99, 99, 99,
99, 99, 98, 2, 3, 8, 11, 13, 3, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98,
5, 6, 6, 7, 16, 15, 3, 18, 7, 5, 18, 4, 18, 18, 2, 99, 99, 99, 99, 99, 99, 98,
98, 98, 98, 98, 7, 18, 9, 9, 18, 1, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98,
98, 98, 7, 17, 5, 11, 2, 2, 1, 1, 5, 2, 1, 6, 7, 18, 1, 6, 7, 98, 1, 98, 99, 99,
99, 99, 99, 99, 99, 99, 99, 18, 98, 98, 7, 98, 98, 98, 98, 98, 98, 3, 4, 13, 5,
2, 1, 6, 7, 98, 99, 98, 98, 99, 98, 98, 98, 18, 4, 18, 6, 1, 7, 6, 1, 12, 12,
18, 98, 11, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 4, 98, 98, 98, 98, 98,
98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 18, 14, 8, 8, 4, 14, 6, 7,
5, 15, 3, 5, 1, 6, 3, 4, 5, 7, 8, 2, 11, 5, 18, 15, 4, 15, 2, 5, 4, 2, 11, 3,
18, 10, 9, 9, 8, 12, 1]
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{5}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{time\PYZus{}range} \PY{o}{=} \PY{n}{ad\PYZus{}time\PYZus{}all}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{time\PYZus{}range}\PY{p}{)}

\PY{n}{opinion\PYZus{}timeline\PYZus{}agents} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{num\PYZus{}agents}\PY{p}{)}\PY{p}{:}
  \PY{n}{opinion\PYZus{}timeline\PYZus{}agent\PYZus{}i} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{l+m+mi}{99}\PY{p}{)}
  \PY{n}{adoption\PYZus{}timepoint} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n}{ad\PYZus{}time\PYZus{}all}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
  \PY{n}{opinion\PYZus{}timeline\PYZus{}agent\PYZus{}i}\PY{o}{=}\PY{p}{[}\PY{l+m+mi}{1} \PY{k}{if} \PY{n}{j} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{adoption\PYZus{}timepoint}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{k}{else} \PY{l+m+mi}{0} \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{time\PYZus{}range}\PY{p}{)} \PY{p}{]} 
  \PY{n}{opinion\PYZus{}timeline\PYZus{}agents}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{opinion\PYZus{}timeline\PYZus{}agent\PYZus{}i}\PY{p}{)}
\PY{n}{opinion\PYZus{}timeline\PYZus{}agents}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{asarray}\PY{p}{(}\PY{n}{opinion\PYZus{}timeline\PYZus{}agents}\PY{p}{)}

\PY{n+nb}{print}\PY{p}{(}\PY{n}{opinion\PYZus{}timeline\PYZus{}agents}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
99
[[0 0 0 {\ldots} 0 0 1]
 [0 0 0 {\ldots} 0 0 1]
 [0 0 0 {\ldots} 0 0 1]
 {\ldots}
 [0 0 0 {\ldots} 1 1 1]
 [0 0 0 {\ldots} 1 1 1]
 [1 1 1 {\ldots} 1 1 1]]
    \end{Verbatim}

    \hypertarget{plot-the-real-percentage-change}{%
\section{plot the real percentage
change}\label{plot-the-real-percentage-change}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{6}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k+kn}{import} \PY{n}{train\PYZus{}test\PYZus{}split}
\PY{k+kn}{import} \PY{n+nn}{seaborn} \PY{k}{as} \PY{n+nn}{sns}

\PY{c+c1}{\PYZsh{} label : percentage of opinion 1 at each timepoint}

\PY{k}{def} \PY{n+nf}{get\PYZus{}change\PYZus{}real}\PY{p}{(}\PY{n}{cluster\PYZus{}index}\PY{p}{)}\PY{p}{:} 
    
    \PY{n}{real\PYZus{}percentage\PYZus{}overtime} \PY{o}{=} \PY{p}{[}\PY{p}{]}

    \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{99}\PY{p}{)}\PY{p}{:}
        \PY{n}{cluster\PYZus{}column\PYZus{}i} \PY{o}{=} \PY{n}{opinion\PYZus{}timeline\PYZus{}agents}\PY{p}{[}\PY{n}{cluster\PYZus{}range}\PY{p}{[}\PY{n}{cluster\PYZus{}index}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{:}\PY{n}{cluster\PYZus{}range}\PY{p}{[}\PY{n}{cluster\PYZus{}index}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,}\PY{n}{i}\PY{p}{]}
        \PY{n}{ones} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{count\PYZus{}nonzero}\PY{p}{(}\PY{n}{cluster\PYZus{}column\PYZus{}i}\PY{p}{)}
        \PY{n}{percent} \PY{o}{=} \PY{n}{ones} \PY{o}{/} \PY{n}{cluster\PYZus{}size}\PY{p}{[}\PY{n}{cluster\PYZus{}index}\PY{p}{]}

        \PY{n}{combined} \PY{o}{=} \PY{p}{[}\PY{p}{]}
        \PY{n}{combined}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{)}
        \PY{n}{combined}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{percent}\PY{p}{)}

        \PY{n}{real\PYZus{}percentage\PYZus{}overtime}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{combined}\PY{p}{)}

    \PY{n}{data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{real\PYZus{}percentage\PYZus{}overtime}\PY{p}{,} \PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time unit}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{percentage}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}  
    
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{cluster }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{cluster\PYZus{}index}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{)}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{p}{)}
    \PY{n}{sns}\PY{o}{.}\PY{n}{set\PYZus{}theme}\PY{p}{(}\PY{p}{)}    
    \PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time unit}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{percentage}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{data}\PY{p}{,}\PY{n}{label} \PY{o}{=} \PY{n}{cluster\PYZus{}names}\PY{p}{[}\PY{n}{cluster\PYZus{}index}\PY{p}{]}\PY{p}{,} \PY{n}{ci}\PY{o}{=}\PY{k+kc}{None}\PY{p}{)}
    
    \PY{k}{return} \PY{n}{real\PYZus{}percentage\PYZus{}overtime}

\PY{n}{real\PYZus{}cluster\PYZus{}0} \PY{o}{=} \PY{n}{get\PYZus{}change\PYZus{}real}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}
\PY{n}{real\PYZus{}cluster\PYZus{}1} \PY{o}{=} \PY{n}{get\PYZus{}change\PYZus{}real}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{real\PYZus{}cluster\PYZus{}2} \PY{o}{=} \PY{n}{get\PYZus{}change\PYZus{}real}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{)}
\PY{n}{real\PYZus{}cluster\PYZus{}3} \PY{o}{=} \PY{n}{get\PYZus{}change\PYZus{}real}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
cluster  0
    time unit  percentage
0           0    0.017241
1           1    0.051724
2           2    0.094828
3           3    0.129310
4           4    0.163793
5           5    0.198276
6           6    0.250000
7           7    0.275862
8           8    0.293103
9           9    0.293103
10         10    0.310345
11         11    0.310345
12         12    0.327586
13         13    0.344828
14         14    0.353448
15         15    0.370690
16         16    0.379310
17         17    0.448276
18         18    0.448276
19         19    0.448276

cluster  1
    time unit  percentage
0           0        0.10
1           1        0.14
2           2        0.16
3           3        0.20
4           4        0.24
5           5        0.30
6           6        0.38
7           7        0.38
8           8        0.38
9           9        0.38
10         10        0.38
11         11        0.38
12         12        0.40
13         13        0.40
14         14        0.40
15         15        0.40
16         16        0.40
17         17        0.46
18         18        0.46
19         19        0.46

cluster  2
    time unit  percentage
0           0    0.045455
1           1    0.045455
2           2    0.045455
3           3    0.068182
4           4    0.068182
5           5    0.113636
6           6    0.136364
7           7    0.159091
8           8    0.159091
9           9    0.159091
10         10    0.181818
11         11    0.227273
12         12    0.227273
13         13    0.250000
14         14    0.250000
15         15    0.250000
16         16    0.250000
17         17    0.318182
18         18    0.318182
19         19    0.318182

cluster  3
    time unit  percentage
0           0    0.055556
1           1    0.138889
2           2    0.222222
3           3    0.333333
4           4    0.472222
5           5    0.527778
6           6    0.583333
7           7    0.666667
8           8    0.722222
9           9    0.750000
10         10    0.805556
11         11    0.833333
12         12    0.833333
13         13    0.861111
14         14    0.944444
15         15    0.944444
16         16    0.944444
17         17    1.000000
18         18    1.000000
19         19    1.000000

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_10_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{plot-the-simulated-percentage-change-with-fixed-parameters}{%
\section{plot the simulated percentage change with fixed
parameters}\label{plot-the-simulated-percentage-change-with-fixed-parameters}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{83}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{linear\PYZus{}model} \PY{k+kn}{import} \PY{n}{LinearRegression}
\PY{k+kn}{import} \PY{n+nn}{math}
\PY{k+kn}{from} \PY{n+nn}{scipy} \PY{k+kn}{import} \PY{n}{stats}


\PY{k}{def} \PY{n+nf}{get\PYZus{}initial\PYZus{}opinions}\PY{p}{(}\PY{n}{cluster\PYZus{}number}\PY{p}{)}\PY{p}{:} 
    \PY{n}{initial\PYZus{}opinions} \PY{o}{=} \PY{p}{[}\PY{p}{]}

    \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{num\PYZus{}agents}\PY{p}{)}\PY{p}{:} 
        \PY{n}{initial\PYZus{}opinions}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{opinion\PYZus{}timeline\PYZus{}agents}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}

    \PY{n}{peoria\PYZus{}initials} \PY{o}{=} \PY{n}{initial\PYZus{}opinions}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{max\PYZus{}node\PYZus{}array}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]}
    \PY{n}{bloomington\PYZus{}initials} \PY{o}{=} \PY{n}{initial\PYZus{}opinions}\PY{p}{[}\PY{n}{cluster\PYZus{}range}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{:}\PY{n}{cluster\PYZus{}range}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{]}
    \PY{n}{quincy\PYZus{}initials} \PY{o}{=} \PY{n}{initial\PYZus{}opinions}\PY{p}{[}\PY{n}{cluster\PYZus{}range}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{:}\PY{n}{cluster\PYZus{}range}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{]}
    \PY{n}{galesburg\PYZus{}initials} \PY{o}{=} \PY{n}{initial\PYZus{}opinions}\PY{p}{[}\PY{n}{cluster\PYZus{}range}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{:}\PY{n}{cluster\PYZus{}range}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{]}
    \PY{n}{opinion\PYZus{}initials\PYZus{}per\PYZus{}cluster} \PY{o}{=} \PY{p}{[}\PY{n}{peoria\PYZus{}initials}\PY{p}{,} \PY{n}{bloomington\PYZus{}initials}\PY{p}{,} \PY{n}{quincy\PYZus{}initials}\PY{p}{,} \PY{n}{galesburg\PYZus{}initials}\PY{p}{]}

    \PY{k}{return} \PY{n}{opinion\PYZus{}initials\PYZus{}per\PYZus{}cluster}\PY{p}{[}\PY{n}{cluster\PYZus{}number}\PY{p}{]}



\PY{c+c1}{\PYZsh{} \PYZsh{} get percentage of opinion 1 at each timepoint with our model}
\PY{k}{def} \PY{n+nf}{get\PYZus{}change\PYZus{}simulated}\PY{p}{(}\PY{n}{cluster\PYZus{}index}\PY{p}{,} \PY{n}{k\PYZus{}alpha}\PY{p}{,} \PY{n}{k\PYZus{}beta}\PY{p}{,} \PY{n}{k\PYZus{}gamma}\PY{p}{,} \PY{n}{E\PYZus{}profit}\PY{p}{)}\PY{p}{:}
    \PY{n}{edge\PYZus{}props} \PY{o}{=} \PY{n}{edge\PYZus{}properties}\PY{p}{[}\PY{n}{cluster\PYZus{}index}\PY{p}{]}
    
    \PY{n}{simulated\PYZus{}percentage\PYZus{}overtime} \PY{o}{=} \PY{p}{[}\PY{p}{]}
    
    \PY{c+c1}{\PYZsh{} initial state}
    \PY{c+c1}{\PYZsh{}initial\PYZus{}state\PYZus{}all = [0,opinion\PYZus{}timeline\PYZus{}agents[:,0]]}
    \PY{c+c1}{\PYZsh{}initial\PYZus{}state\PYZus{}this\PYZus{}cluster = initial\PYZus{}state\PYZus{}all[cluster\PYZus{}range[i][0]:cluster\PYZus{}range[i][1]]}
    
    \PY{c+c1}{\PYZsh{}simulated\PYZus{}percentage\PYZus{}overtime.append(initial\PYZus{}state\PYZus{}this\PYZus{}cluster)}
    \PY{n}{initial\PYZus{}state\PYZus{}this\PYZus{}cluster} \PY{o}{=} \PY{n}{get\PYZus{}initial\PYZus{}opinions}\PY{p}{(}\PY{n}{cluster\PYZus{}index}\PY{p}{)}
    \PY{n}{current\PYZus{}state} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{initial\PYZus{}state\PYZus{}this\PYZus{}cluster} \PY{p}{]}
    \PY{n}{simulated\PYZus{}percentage\PYZus{}overtime}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{count\PYZus{}nonzero}\PY{p}{(}\PY{n}{initial\PYZus{}state\PYZus{}this\PYZus{}cluster}\PY{p}{)}\PY{o}{/}\PY{n}{cluster\PYZus{}size}\PY{p}{[}\PY{n}{cluster\PYZus{}index}\PY{p}{]}\PY{p}{]}\PY{p}{)}
    
    \PY{c+c1}{\PYZsh{} calculate driving force(cluster specific)}
    \PY{n}{driving\PYZus{}force} \PY{o}{=} \PY{n}{update\PYZus{}driving\PYZus{}forces\PYZus{}cluster\PYZus{}specific}\PY{p}{(}\PY{n}{edge\PYZus{}props}\PY{p}{,} \PY{n}{cluster\PYZus{}index}\PY{p}{,} \PY{n}{current\PYZus{}state}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
    
    \PY{c+c1}{\PYZsh{} later states}
    \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{25}\PY{p}{)}\PY{p}{:}
        \PY{n}{new\PYZus{}opinions}\PY{p}{,} \PY{n}{driving\PYZus{}force} \PY{o}{=} \PY{n}{update}\PY{p}{(}\PY{n}{driving\PYZus{}force}\PY{p}{,} \PY{n}{edge\PYZus{}props}\PY{p}{,} \PY{n}{cluster\PYZus{}index}\PY{p}{,} \PY{n}{current\PYZus{}state}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
        \PY{n}{current\PYZus{}state} \PY{o}{=} \PY{p}{[}\PY{n}{i}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{new\PYZus{}opinions} \PY{p}{]}
        \PY{n}{simulated\PYZus{}percentage\PYZus{}overtime}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{[}\PY{n}{i}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{count\PYZus{}nonzero}\PY{p}{(}\PY{n}{new\PYZus{}opinions}\PY{p}{)}\PY{o}{/}\PY{n}{cluster\PYZus{}size}\PY{p}{[}\PY{n}{cluster\PYZus{}index}\PY{p}{]}\PY{p}{]}\PY{p}{)}
        
        
    \PY{c+c1}{\PYZsh{} plotting}
    \PY{n}{simulation}\PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{simulated\PYZus{}percentage\PYZus{}overtime}\PY{p}{,} \PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time unit}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{percentage}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}  
    
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{cluster }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{cluster\PYZus{}index}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{n}{simulation}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{25}\PY{p}{)}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{p}{)}
    \PY{n}{sns}\PY{o}{.}\PY{n}{set\PYZus{}theme}\PY{p}{(}\PY{p}{)}    
    \PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time unit}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{percentage}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{simulation}\PY{p}{,} \PY{n}{label} \PY{o}{=}\PY{n}{cluster\PYZus{}names}\PY{p}{[}\PY{n}{cluster\PYZus{}index}\PY{p}{]}\PY{p}{,}\PY{n}{ci}\PY{o}{=}\PY{k+kc}{None}\PY{p}{)}
    

\PY{k}{def} \PY{n+nf}{update\PYZus{}driving\PYZus{}forces\PYZus{}cluster\PYZus{}specific}\PY{p}{(}\PY{n}{edge\PYZus{}props}\PY{p}{,} \PY{n}{cluster\PYZus{}number}\PY{p}{,} \PY{n}{opinions}\PY{p}{)}\PY{p}{:} 
    \PY{n}{len\PYZus{}cluster} \PY{o}{=} \PY{l+m+mi}{0}
    \PY{n}{first\PYZus{}node} \PY{o}{=} \PY{l+m+mi}{0}
    \PY{k}{if} \PY{n}{cluster\PYZus{}number} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:} 
        \PY{n}{len\PYZus{}cluster} \PY{o}{=} \PY{n}{max\PYZus{}node\PYZus{}array}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
    \PY{k}{else}\PY{p}{:} 
        \PY{n}{len\PYZus{}cluster} \PY{o}{=} \PY{n}{max\PYZus{}node\PYZus{}array}\PY{p}{[}\PY{n}{cluster\PYZus{}number}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{n}{max\PYZus{}node\PYZus{}array}\PY{p}{[}\PY{n}{cluster\PYZus{}number}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{first\PYZus{}node} \PY{o}{=} \PY{n}{max\PYZus{}node\PYZus{}array}\PY{p}{[}\PY{n}{cluster\PYZus{}number}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
    
    \PY{n}{updated\PYZus{}driving\PYZus{}force} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{len\PYZus{}cluster}\PY{p}{)}

    \PY{n}{agents\PYZus{}ids} \PY{o}{=} \PY{p}{[}\PY{n}{first\PYZus{}node}\PY{o}{+}\PY{n}{i} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{len\PYZus{}cluster}\PY{p}{)}\PY{p}{]}

    \PY{k}{for} \PY{n}{a} \PY{o+ow}{in} \PY{n}{agents\PYZus{}ids}\PY{p}{:}
        \PY{k}{for} \PY{n}{edge} \PY{o+ow}{in} \PY{n}{edge\PYZus{}props}\PY{p}{:} 
           \PY{c+c1}{\PYZsh{}check that the edge is directed at node a and opinions of agents don\PYZsq{}t match}
           \PY{k}{if} \PY{n}{edge}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{==} \PY{n}{a} \PY{o+ow}{and}  \PY{o+ow}{not} \PY{n}{opinions}\PY{p}{[}\PY{n}{a}\PY{o}{\PYZhy{}}\PY{n}{first\PYZus{}node}\PY{p}{]} \PY{o}{==} \PY{n}{opinions}\PY{p}{[}\PY{n}{edge}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{n}{first\PYZus{}node}\PY{p}{]}\PY{p}{:} 
                \PY{n}{updated\PYZus{}driving\PYZus{}force}\PY{p}{[}\PY{n}{a}\PY{o}{\PYZhy{}}\PY{n}{first\PYZus{}node}\PY{p}{]} \PY{o}{+}\PY{o}{=} \PY{n}{edge}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]} \PY{o}{*} \PY{n}{k\PYZus{}alpha} \PY{o}{+} \PY{n}{edge}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]} \PY{o}{*} \PY{n}{k\PYZus{}beta} \PY{o}{+} \PY{n}{edge}\PY{p}{[}\PY{l+m+mi}{4}\PY{p}{]}\PY{o}{*}\PY{n}{k\PYZus{}gamma}
        \PY{n}{updated\PYZus{}driving\PYZus{}force}\PY{p}{[}\PY{n}{a}\PY{o}{\PYZhy{}}\PY{n}{first\PYZus{}node}\PY{p}{]}\PY{o}{+}\PY{o}{=}\PY{n}{E\PYZus{}profit}
        \PY{c+c1}{\PYZsh{}print(\PYZdq{}agent \PYZob{}\PYZcb{} obtained a driving force of \PYZob{}\PYZcb{}\PYZdq{}.format(a, updated\PYZus{}driving\PYZus{}force[a]))}

    \PY{k}{return} \PY{n}{updated\PYZus{}driving\PYZus{}force} 


\PY{k}{def} \PY{n+nf}{prob\PYZus{}of\PYZus{}change}\PY{p}{(}\PY{n}{driving\PYZus{}forces}\PY{p}{)}\PY{p}{:}
    \PY{n}{driving\PYZus{}forces} \PY{o}{=} \PY{n}{normalise\PYZus{}driving\PYZus{}force}\PY{p}{(}\PY{n}{driving\PYZus{}forces}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mi}{2} \PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
    \PY{n}{probs} \PY{o}{=} \PY{n}{stats}\PY{o}{.}\PY{n}{norm}\PY{o}{.}\PY{n}{cdf}\PY{p}{(}\PY{n}{driving\PYZus{}forces}\PY{p}{)}
    \PY{c+c1}{\PYZsh{}probs = np.repeat(0.01, len(driving\PYZus{}forces))}
    \PY{c+c1}{\PYZsh{}probs = driving\PYZus{}forces/(len(driving\PYZus{}forces) * k\PYZus{}alpha + E\PYZus{}profit)}
    \PY{c+c1}{\PYZsh{}print(probs)}
    \PY{k}{return} \PY{n}{probs}

\PY{k}{def} \PY{n+nf}{normalise\PYZus{}driving\PYZus{}force}\PY{p}{(}\PY{n}{driving\PYZus{}forces}\PY{p}{,} \PY{n}{a}\PY{p}{,} \PY{n}{b}\PY{p}{)}\PY{p}{:}
    \PY{n}{min\PYZus{}val} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{amin}\PY{p}{(}\PY{n}{driving\PYZus{}forces}\PY{p}{)}
    \PY{c+c1}{\PYZsh{}max\PYZus{}val = np.amax(driving\PYZus{}forces)}
    \PY{n}{max\PYZus{}val} \PY{o}{=} \PY{p}{(}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{driving\PYZus{}forces}\PY{p}{)} \PY{o}{*} \PY{p}{(}\PY{n}{k\PYZus{}alpha}\PY{o}{+}\PY{n}{k\PYZus{}beta}\PY{o}{+}\PY{n}{k\PYZus{}gamma}\PY{p}{)}\PY{p}{)} \PY{o}{+} \PY{n}{E\PYZus{}profit}\PY{p}{)}
    \PY{c+c1}{\PYZsh{}return (b\PYZhy{}a) * (driving\PYZus{}forces\PYZhy{}min\PYZus{}val)/(max\PYZus{}val\PYZhy{}min\PYZus{}val) \PYZhy{} a}
    \PY{k}{return} \PY{p}{(}\PY{p}{(}\PY{n}{b}\PY{o}{\PYZhy{}}\PY{n}{a}\PY{p}{)}\PY{o}{*} \PY{n}{driving\PYZus{}forces}\PY{o}{/}\PY{n}{max\PYZus{}val}\PY{p}{)}\PY{o}{+}\PY{n}{a}

\PY{k}{def} \PY{n+nf}{opinion}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{p}\PY{p}{)}\PY{p}{:}
    \PY{n}{res} \PY{o}{=} \PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{rand}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
    \PY{k}{return} \PY{l+m+mi}{1}\PY{o}{\PYZhy{}}\PY{n}{x} \PY{k}{if} \PY{n}{res} \PY{o}{\PYZlt{}} \PY{n}{p} \PY{k}{else} \PY{n}{x}
    
\PY{k}{def} \PY{n+nf}{opinion\PYZus{}no\PYZus{}return}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{p}\PY{p}{)}\PY{p}{:} 
    \PY{k}{if}\PY{p}{(}\PY{n}{x} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
        \PY{k}{return} \PY{l+m+mi}{1}
    \PY{k}{else}\PY{p}{:} 
        \PY{k}{return} \PY{n}{opinion}\PY{p}{(}\PY{n}{x}\PY{p}{,}\PY{n}{p}\PY{p}{)} 


\PY{k}{def} \PY{n+nf}{update}\PY{p}{(}\PY{n}{driving\PYZus{}forces}\PY{p}{,} \PY{n}{edge\PYZus{}props}\PY{p}{,} \PY{n}{cluster\PYZus{}index}\PY{p}{,} \PY{n}{current\PYZus{}state}\PY{p}{)}\PY{p}{:}
    \PY{n}{new\PYZus{}states} \PY{o}{=} \PY{p}{[}\PY{p}{]}
    \PY{n}{prob} \PY{o}{=} \PY{n}{prob\PYZus{}of\PYZus{}change}\PY{p}{(}\PY{n}{driving\PYZus{}forces}\PY{p}{)}
    \PY{k}{for} \PY{n}{agent} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{cluster\PYZus{}size}\PY{p}{[}\PY{n}{cluster\PYZus{}index}\PY{p}{]}\PY{p}{)}\PY{p}{:}
        \PY{c+c1}{\PYZsh{}new\PYZus{}state = opinion(current\PYZus{}state[agent], prob[agent])}
        \PY{n}{new\PYZus{}state\PYZus{}no\PYZus{}return} \PY{o}{=} \PY{n}{opinion\PYZus{}no\PYZus{}return}\PY{p}{(}\PY{n}{current\PYZus{}state}\PY{p}{[}\PY{n}{agent}\PY{p}{]}\PY{p}{,} \PY{n}{prob}\PY{p}{[}\PY{n}{agent}\PY{p}{]}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}new\PYZus{}states.append(new\PYZus{}state)}
        \PY{n}{new\PYZus{}states}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{new\PYZus{}state\PYZus{}no\PYZus{}return}\PY{p}{)}
    
    \PY{n}{new\PYZus{}driving\PYZus{}force} \PY{o}{=} \PY{n}{update\PYZus{}driving\PYZus{}forces\PYZus{}cluster\PYZus{}specific}\PY{p}{(}\PY{n}{edge\PYZus{}props}\PY{p}{,} \PY{n}{cluster\PYZus{}index}\PY{p}{,} \PY{n}{current\PYZus{}state}\PY{p}{)}
    
    \PY{k}{return} \PY{n}{new\PYZus{}states}\PY{p}{,} \PY{n}{new\PYZus{}driving\PYZus{}force}
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{with-return}{%
\section{With return:}\label{with-return}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{75}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{get\PYZus{}change\PYZus{}simulated}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{15}\PY{p}{)}
\PY{n}{get\PYZus{}change\PYZus{}simulated}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{15}\PY{p}{)}
\PY{n}{get\PYZus{}change\PYZus{}simulated}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{15}\PY{p}{)}
\PY{n}{get\PYZus{}change\PYZus{}simulated}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{15}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
cluster  0
    time unit  percentage
0           0    0.017241
1           1    0.034483
2           2    0.051724
3           3    0.077586
4           4    0.086207
5           5    0.094828
6           6    0.094828
7           7    0.112069
8           8    0.112069
9           9    0.120690
10         10    0.129310
11         11    0.146552
12         12    0.163793
13         13    0.172414
14         14    0.198276
15         15    0.206897
16         16    0.232759
17         17    0.241379
18         18    0.250000
19         19    0.250000
20         20    0.293103
21         21    0.267241
22         22    0.275862
23         23    0.284483
24         24    0.301724

cluster  1
    time unit  percentage
0           0        0.10
1           1        0.12
2           2        0.12
3           3        0.22
4           4        0.24
5           5        0.26
6           6        0.28
7           7        0.28
8           8        0.30
9           9        0.28
10         10        0.30
11         11        0.34
12         12        0.34
13         13        0.38
14         14        0.42
15         15        0.42
16         16        0.48
17         17        0.42
18         18        0.44
19         19        0.50
20         20        0.52
21         21        0.50
22         22        0.52
23         23        0.58
24         24        0.60

cluster  2
    time unit  percentage
0           0    0.045455
1           1    0.159091
2           2    0.181818
3           3    0.272727
4           4    0.272727
5           5    0.318182
6           6    0.318182
7           7    0.295455
8           8    0.318182
9           9    0.340909
10         10    0.272727
11         11    0.250000
12         12    0.272727
13         13    0.295455
14         14    0.295455
15         15    0.295455
16         16    0.318182
17         17    0.272727
18         18    0.272727
19         19    0.272727
20         20    0.272727
21         21    0.340909
22         22    0.340909
23         23    0.318182
24         24    0.318182

cluster  3
    time unit  percentage
0           0    0.055556
1           1    0.055556
2           2    0.166667
3           3    0.166667
4           4    0.222222
5           5    0.222222
6           6    0.250000
7           7    0.250000
8           8    0.277778
9           9    0.305556
10         10    0.361111
11         11    0.388889
12         12    0.444444
13         13    0.472222
14         14    0.472222
15         15    0.500000
16         16    0.500000
17         17    0.500000
18         18    0.444444
19         19    0.527778
20         20    0.583333
21         21    0.638889
22         22    0.722222
23         23    0.750000
24         24    0.750000

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_14_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{no-return-allowed}{%
\section{no return allowed}\label{no-return-allowed}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{84}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{get\PYZus{}change\PYZus{}simulated}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{15}\PY{p}{)}
\PY{n}{get\PYZus{}change\PYZus{}simulated}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{15}\PY{p}{)}
\PY{n}{get\PYZus{}change\PYZus{}simulated}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{15}\PY{p}{)}
\PY{n}{get\PYZus{}change\PYZus{}simulated}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{15}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
cluster  0
    time unit  percentage
0           0    0.017241
1           1    0.068966
2           2    0.103448
3           3    0.129310
4           4    0.137931
5           5    0.146552
6           6    0.172414
7           7    0.189655
8           8    0.206897
9           9    0.215517
10         10    0.232759
11         11    0.250000
12         12    0.284483
13         13    0.284483
14         14    0.293103
15         15    0.310345
16         16    0.318966
17         17    0.336207
18         18    0.344828
19         19    0.379310
20         20    0.413793
21         21    0.422414
22         22    0.439655
23         23    0.474138
24         24    0.474138

cluster  1
    time unit  percentage
0           0        0.10
1           1        0.12
2           2        0.16
3           3        0.20
4           4        0.20
5           5        0.26
6           6        0.30
7           7        0.34
8           8        0.38
9           9        0.40
10         10        0.40
11         11        0.42
12         12        0.44
13         13        0.44
14         14        0.48
15         15        0.54
16         16        0.58
17         17        0.58
18         18        0.60
19         19        0.60
20         20        0.68
21         21        0.68
22         22        0.68
23         23        0.68
24         24        0.72

cluster  2
    time unit  percentage
0           0    0.045455
1           1    0.068182
2           2    0.068182
3           3    0.090909
4           4    0.136364
5           5    0.204545
6           6    0.227273
7           7    0.227273
8           8    0.272727
9           9    0.318182
10         10    0.340909
11         11    0.386364
12         12    0.431818
13         13    0.431818
14         14    0.431818
15         15    0.477273
16         16    0.500000
17         17    0.522727
18         18    0.522727
19         19    0.568182
20         20    0.568182
21         21    0.568182
22         22    0.590909
23         23    0.613636
24         24    0.659091

cluster  3
    time unit  percentage
0           0    0.055556
1           1    0.055556
2           2    0.083333
3           3    0.166667
4           4    0.194444
5           5    0.277778
6           6    0.277778
7           7    0.305556
8           8    0.305556
9           9    0.333333
10         10    0.388889
11         11    0.416667
12         12    0.416667
13         13    0.472222
14         14    0.472222
15         15    0.472222
16         16    0.583333
17         17    0.583333
18         18    0.611111
19         19    0.611111
20         20    0.611111
21         21    0.611111
22         22    0.611111
23         23    0.611111
24         24    0.611111

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_16_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{set-the-model}{%
\section{\texorpdfstring{\textbf{set the
model}}{set the model}}\label{set-the-model}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{85}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{torch}\PY{n+nn}{.}\PY{n+nn}{nn} \PY{k}{as} \PY{n+nn}{nn}
\PY{k+kn}{import} \PY{n+nn}{torch}
\PY{k+kn}{from} \PY{n+nn}{torch}\PY{n+nn}{.}\PY{n+nn}{utils}\PY{n+nn}{.}\PY{n+nn}{tensorboard} \PY{k+kn}{import} \PY{n}{SummaryWriter}

\PY{k+kn}{from} \PY{n+nn}{tqdm} \PY{k+kn}{import} \PY{n}{tqdm}
\PY{k}{class} \PY{n+nc}{SimpleFCNet}\PY{p}{(}\PY{n}{nn}\PY{o}{.}\PY{n}{Module}\PY{p}{)}\PY{p}{:}

    \PY{k}{def} \PY{n+nf+fm}{\PYZus{}\PYZus{}init\PYZus{}\PYZus{}}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{num\PYZus{}layers}\PY{p}{,} \PY{n}{in\PYZus{}dim}\PY{p}{,} \PY{n}{out\PYZus{}dim}\PY{p}{,} \PY{n}{hidden\PYZus{}dim}\PY{p}{,} \PY{n}{use\PYZus{}bn}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{p}{:}
        \PY{n+nb}{super}\PY{p}{(}\PY{n}{SimpleFCNet}\PY{p}{,} \PY{n+nb+bp}{self}\PY{p}{)}\PY{o}{.}\PY{n+nf+fm}{\PYZus{}\PYZus{}init\PYZus{}\PYZus{}}\PY{p}{(}\PY{p}{)}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{num\PYZus{}layers} \PY{o}{=} \PY{n}{num\PYZus{}layers}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{sigm} \PY{o}{=} \PY{n}{nn}\PY{o}{.}\PY{n}{Sigmoid}\PY{p}{(}\PY{p}{)}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{fc\PYZus{}in} \PY{o}{=} \PY{n}{nn}\PY{o}{.}\PY{n}{Linear}\PY{p}{(}\PY{n}{in\PYZus{}dim}\PY{p}{,} \PY{n}{hidden\PYZus{}dim}\PY{p}{)}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{fc\PYZus{}out} \PY{o}{=} \PY{n}{nn}\PY{o}{.}\PY{n}{Linear}\PY{p}{(}\PY{n}{hidden\PYZus{}dim}\PY{p}{,} \PY{n}{out\PYZus{}dim}\PY{p}{)}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{fc\PYZus{}hidd} \PY{o}{=} \PY{n}{nn}\PY{o}{.}\PY{n}{Linear}\PY{p}{(}\PY{n}{hidden\PYZus{}dim}\PY{p}{,} \PY{n}{hidden\PYZus{}dim}\PY{p}{)}

        \PY{c+c1}{\PYZsh{} self.use\PYZus{}bn = use\PYZus{}bn}
        \PY{c+c1}{\PYZsh{} self.bn = nn.BatchNorm1d()}

        \PY{n}{layers} \PY{o}{=} \PY{p}{[}\PY{p}{]}
        \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{num\PYZus{}layers} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
            \PY{c+c1}{\PYZsh{} if self.use\PYZus{}bn:}
            \PY{c+c1}{\PYZsh{}     layers.append()}
            \PY{k}{if} \PY{n}{i} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
                \PY{n}{layers}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{fc\PYZus{}in}\PY{p}{)}
            \PY{k}{elif} \PY{n}{i} \PY{o}{==} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{num\PYZus{}layers}\PY{p}{:}
                \PY{n}{layers}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{fc\PYZus{}out}\PY{p}{)}
            \PY{k}{else}\PY{p}{:}
                \PY{n}{layers}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{fc\PYZus{}hidd}\PY{p}{)}
            \PY{n}{layers}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{sigm}\PY{p}{)}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{net} \PY{o}{=} \PY{n}{nn}\PY{o}{.}\PY{n}{Sequential}\PY{p}{(}\PY{o}{*}\PY{n}{layers}\PY{p}{)}


    \PY{k}{def} \PY{n+nf}{forward}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{x}\PY{p}{)}\PY{p}{:}
        \PY{k}{return} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{net}\PY{p}{(}\PY{n}{x}\PY{p}{)}

\PY{c+c1}{\PYZsh{} x = [parameters\PYZus{}to\PYZus{}fit, driving\PYZus{}forces]}
\PY{k}{def} \PY{n+nf}{train}\PY{p}{(}\PY{n}{model}\PY{p}{,} \PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{timestep}\PY{p}{,} \PY{n}{all\PYZus{}opinion}\PY{p}{,} \PY{n}{writer}\PY{o}{=}\PY{k+kc}{None}\PY{p}{)}\PY{p}{:}
    \PY{n}{num\PYZus{}epochs} \PY{o}{=} \PY{l+m+mi}{50}
    \PY{n}{learning\PYZus{}rate} \PY{o}{=} \PY{l+m+mf}{1e\PYZhy{}2}
    \PY{n}{optimizer} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{optim}\PY{o}{.}\PY{n}{Adam}\PY{p}{(}\PY{n}{params}\PY{o}{=}\PY{n}{model}\PY{o}{.}\PY{n}{parameters}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{lr}\PY{o}{=}\PY{n}{learning\PYZus{}rate}\PY{p}{)}
    \PY{n}{loss} \PY{o}{=} \PY{n}{nn}\PY{o}{.}\PY{n}{MSELoss}\PY{p}{(}\PY{p}{)}
    
    \PY{k}{def} \PY{n+nf}{opinion}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{p}\PY{p}{)}\PY{p}{:}
        \PY{n}{res} \PY{o}{=} \PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{rand}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
        \PY{k}{return} \PY{l+m+mi}{1}\PY{o}{\PYZhy{}}\PY{n}{x} \PY{k}{if} \PY{n}{res} \PY{o}{\PYZlt{}} \PY{n}{p} \PY{k}{else} \PY{n}{x}

    \PY{k}{def} \PY{n+nf}{opinion\PYZus{}no\PYZus{}return}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{p}\PY{p}{)}\PY{p}{:} 
        \PY{k}{if}\PY{p}{(}\PY{n}{x} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
            \PY{k}{return} \PY{l+m+mi}{1}
        \PY{k}{else}\PY{p}{:} 
            \PY{k}{return} \PY{n}{opinion}\PY{p}{(}\PY{n}{x}\PY{p}{,}\PY{n}{p}\PY{p}{)} 

    \PY{k}{def} \PY{n+nf}{get\PYZus{}opinion}\PY{p}{(}\PY{n}{current\PYZus{}opinion}\PY{p}{,} \PY{n}{res}\PY{p}{,} \PY{n}{step}\PY{p}{)}\PY{p}{:}
        \PY{n}{opinions} \PY{o}{=} \PY{p}{[}\PY{p}{]}
        \PY{n}{prob} \PY{o}{=} \PY{n}{res}
        \PY{k}{for} \PY{n}{agent} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{res}\PY{p}{)}\PY{p}{)}\PY{p}{:}
            \PY{n}{new\PYZus{}state\PYZus{}no\PYZus{}return} \PY{o}{=} \PY{n}{opinion\PYZus{}no\PYZus{}return}\PY{p}{(}\PY{n}{current\PYZus{}opinion}\PY{p}{[}\PY{n}{agent}\PY{p}{]}\PY{p}{,} \PY{n}{prob}\PY{p}{[}\PY{n}{agent}\PY{p}{]}\PY{p}{)}
            \PY{n}{opinions}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{new\PYZus{}state\PYZus{}no\PYZus{}return}\PY{p}{)}
        \PY{n}{opinions} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{tensor}\PY{p}{(}\PY{n}{opinions}\PY{p}{)}\PY{o}{.}\PY{n}{float}\PY{p}{(}\PY{p}{)}
        \PY{n}{opinions}\PY{o}{.}\PY{n}{requires\PYZus{}grad}\PY{o}{=}\PY{k+kc}{True}
        \PY{k}{return} \PY{n}{opinions}

    \PY{n}{dfs} \PY{o}{=} \PY{n}{x}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{detach}\PY{p}{(}\PY{p}{)}
    \PY{n}{params} \PY{o}{=} \PY{n}{x}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}

    \PY{n}{res} \PY{o}{=} \PY{k+kc}{None}
    
    \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{tqdm}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{n}{num\PYZus{}epochs}\PY{p}{)}\PY{p}{,} \PY{n}{desc}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{training model ...}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:}
        \PY{n}{optimizer}\PY{o}{.}\PY{n}{zero\PYZus{}grad}\PY{p}{(}\PY{p}{)}
        \PY{n}{inp} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{cat}\PY{p}{(}\PY{p}{(}\PY{n}{params}\PY{p}{,} \PY{n}{dfs}\PY{p}{)}\PY{p}{)}
        \PY{n}{inp} \PY{o}{=} \PY{n}{inp}\PY{o}{.}\PY{n}{float}\PY{p}{(}\PY{p}{)}
        \PY{n}{res} \PY{o}{=} \PY{n}{model}\PY{p}{(}\PY{n}{inp}\PY{p}{)}
        
        \PY{n}{x} \PY{o}{=} \PY{n}{get\PYZus{}opinion}\PY{p}{(}\PY{n}{all\PYZus{}opinion}\PY{p}{[}\PY{n}{timestep}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{res}\PY{p}{,} \PY{n}{timestep}\PY{p}{)}
        
        \PY{n}{model\PYZus{}loss} \PY{o}{=} \PY{n}{loss}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{o}{.}\PY{n}{float}\PY{p}{(}\PY{p}{)}\PY{p}{)} \PY{c+c1}{\PYZsh{}TODO: create a meaningful loss function}
        
        
\PY{c+c1}{\PYZsh{}         if writer is not None:}
\PY{c+c1}{\PYZsh{}             writer.add\PYZus{}scalar(\PYZsq{}training loss time step \PYZob{}\PYZcb{}\PYZsq{}.format(timestep), model\PYZus{}loss, i)}
\PY{c+c1}{\PYZsh{}         else:}
\PY{c+c1}{\PYZsh{}             print(\PYZdq{}epoch \PYZob{}\PYZcb{}: loss = \PYZob{}\PYZcb{}\PYZdq{}.format(i, model\PYZus{}loss))}
        \PY{n}{model\PYZus{}loss}\PY{o}{.}\PY{n}{backward}\PY{p}{(}\PY{p}{)}
        
        \PY{n}{optimizer}\PY{o}{.}\PY{n}{step}\PY{p}{(}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{n}{params}\PY{o}{.}\PY{n}{grad}\PY{p}{)}

    \PY{k}{return} \PY{n}{params}\PY{p}{,} \PY{n}{get\PYZus{}opinion}\PY{p}{(}\PY{n}{all\PYZus{}opinion}\PY{p}{[}\PY{n}{timestep}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{res}\PY{p}{,} \PY{n}{timestep}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{86}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} plot function for model}
\PY{k}{def} \PY{n+nf}{plot}\PY{p}{(}\PY{n}{all\PYZus{}opinions}\PY{p}{,} \PY{n}{cluster\PYZus{}index}\PY{p}{)}\PY{p}{:}
    
    
    \PY{n}{model\PYZus{}percentage\PYZus{}overtime} \PY{o}{=} \PY{p}{[}\PY{p}{]}
    \PY{n}{initial\PYZus{}percent} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{count\PYZus{}nonzero}\PY{p}{(}\PY{n}{all\PYZus{}opinions}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{o}{/}\PY{n}{cluster\PYZus{}size}\PY{p}{[}\PY{n}{cluster\PYZus{}index}\PY{p}{]}
    \PY{n}{model\PYZus{}percentage\PYZus{}overtime}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{initial\PYZus{}percent}\PY{p}{]}\PY{p}{)}
    
    
    \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{all\PYZus{}opinions}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
        
        \PY{n}{opinion} \PY{o}{=} \PY{n}{all\PYZus{}opinions}\PY{p}{[}\PY{n}{i} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{ones} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{count\PYZus{}nonzero}\PY{p}{(}\PY{n}{opinion}\PY{o}{.}\PY{n}{detach}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{numpy}\PY{p}{(}\PY{p}{)}\PY{p}{)}
        \PY{n}{percent} \PY{o}{=} \PY{n}{ones} \PY{o}{/} \PY{n}{cluster\PYZus{}size}\PY{p}{[}\PY{n}{cluster\PYZus{}index}\PY{p}{]}

        \PY{n}{combined} \PY{o}{=} \PY{p}{[}\PY{p}{]}
        \PY{n}{combined}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}
        \PY{n}{combined}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{percent}\PY{p}{)}

        \PY{n}{model\PYZus{}percentage\PYZus{}overtime}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{combined}\PY{p}{)}
        
    \PY{n}{model\PYZus{}data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{model\PYZus{}percentage\PYZus{}overtime}\PY{p}{,} \PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time unit}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{percentage}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}  
    
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{cluster }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{cluster\PYZus{}index}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{n}{model\PYZus{}data}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{)}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{p}{)}
    \PY{n}{sns}\PY{o}{.}\PY{n}{set\PYZus{}theme}\PY{p}{(}\PY{p}{)}    
    \PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time unit}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{percentage}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{model\PYZus{}data}\PY{p}{,}\PY{n}{label} \PY{o}{=} \PY{n}{cluster\PYZus{}names}\PY{p}{[}\PY{n}{cluster\PYZus{}index}\PY{p}{]}\PY{p}{,} \PY{n}{ci}\PY{o}{=}\PY{k+kc}{None}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{87}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{update\PYZus{}driving\PYZus{}forces\PYZus{}model}\PY{p}{(}\PY{n}{opinions}\PY{p}{,} \PY{n}{driving\PYZus{}forces}\PY{p}{,} \PY{n}{edge\PYZus{}props}\PY{p}{,} \PY{n}{cluster\PYZus{}index}\PY{p}{,} \PY{n}{k\PYZus{}alpha\PYZus{}model}\PY{p}{,}
        \PY{n}{k\PYZus{}beta\PYZus{}model}\PY{p}{,}
        \PY{n}{k\PYZus{}gamma\PYZus{}model}\PY{p}{,}\PY{n}{E\PYZus{}profit\PYZus{}model}\PY{p}{)}\PY{p}{:} 
    \PY{n}{len\PYZus{}cluster} \PY{o}{=} \PY{l+m+mi}{0}
    \PY{n}{first\PYZus{}node} \PY{o}{=} \PY{l+m+mi}{0}
    \PY{k}{if} \PY{n}{cluster\PYZus{}index} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:} 
        \PY{n}{len\PYZus{}cluster} \PY{o}{=} \PY{n}{max\PYZus{}node\PYZus{}array}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
    \PY{k}{else}\PY{p}{:} 
        \PY{n}{len\PYZus{}cluster} \PY{o}{=} \PY{n}{max\PYZus{}node\PYZus{}array}\PY{p}{[}\PY{n}{cluster\PYZus{}index}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{n}{max\PYZus{}node\PYZus{}array}\PY{p}{[}\PY{n}{cluster\PYZus{}index}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{first\PYZus{}node} \PY{o}{=} \PY{n}{max\PYZus{}node\PYZus{}array}\PY{p}{[}\PY{n}{cluster\PYZus{}index}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
    
    \PY{n}{updated\PYZus{}driving\PYZus{}force} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{len\PYZus{}cluster}\PY{p}{)}

    \PY{n}{agents\PYZus{}ids} \PY{o}{=} \PY{p}{[}\PY{n}{first\PYZus{}node}\PY{o}{+}\PY{n}{i} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{len\PYZus{}cluster}\PY{p}{)}\PY{p}{]}

    \PY{k}{for} \PY{n}{a} \PY{o+ow}{in} \PY{n}{agents\PYZus{}ids}\PY{p}{:}
        \PY{k}{for} \PY{n}{edge} \PY{o+ow}{in} \PY{n}{edge\PYZus{}props}\PY{p}{:} 
           \PY{c+c1}{\PYZsh{}check that the edge is directed at node a and opinions of agents don\PYZsq{}t match}
           \PY{k}{if} \PY{n}{edge}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{==} \PY{n}{a} \PY{o+ow}{and} \PY{o+ow}{not} \PY{n}{opinions}\PY{p}{[}\PY{n}{a}\PY{o}{\PYZhy{}}\PY{n}{first\PYZus{}node}\PY{p}{]} \PY{o}{==} \PY{n}{opinions}\PY{p}{[}\PY{n}{edge}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{n}{first\PYZus{}node}\PY{p}{]}\PY{p}{:} 
                \PY{n}{updated\PYZus{}driving\PYZus{}force}\PY{p}{[}\PY{n}{a}\PY{o}{\PYZhy{}}\PY{n}{first\PYZus{}node}\PY{p}{]} \PY{o}{+}\PY{o}{=} \PY{n}{edge}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]} \PY{o}{*} \PY{n}{k\PYZus{}alpha\PYZus{}model} \PY{o}{+} \PY{n}{edge}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]} \PY{o}{*} \PY{n}{k\PYZus{}beta\PYZus{}model} \PY{o}{+} \PY{n}{edge}\PY{p}{[}\PY{l+m+mi}{4}\PY{p}{]}\PY{o}{*}\PY{n}{k\PYZus{}gamma\PYZus{}model}
        \PY{n}{updated\PYZus{}driving\PYZus{}force}\PY{p}{[}\PY{n}{a}\PY{o}{\PYZhy{}}\PY{n}{first\PYZus{}node}\PY{p}{]}\PY{o}{+}\PY{o}{=}\PY{n}{E\PYZus{}profit\PYZus{}model}
        \PY{c+c1}{\PYZsh{}print(\PYZdq{}agent \PYZob{}\PYZcb{} obtained a driving force of \PYZob{}\PYZcb{}\PYZdq{}.format(a, updated\PYZus{}driving\PYZus{}force[a]))}

    \PY{k}{return} \PY{n}{updated\PYZus{}driving\PYZus{}force} 



\PY{n}{k\PYZus{}alpha\PYZus{}model} \PY{o}{=}\PY{o}{.}\PY{l+m+mi}{1}
\PY{n}{k\PYZus{}beta\PYZus{}model} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{k\PYZus{}gamma\PYZus{}model} \PY{o}{=} \PY{l+m+mi}{2}
\PY{n}{E\PYZus{}profit\PYZus{}model} \PY{o}{=} \PY{l+m+mi}{15}

\PY{n}{parameters\PYZus{}to\PYZus{}fit} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{tensor}\PY{p}{(}
        \PY{p}{[}\PY{n}{k\PYZus{}alpha\PYZus{}model}\PY{p}{,}
        \PY{n}{k\PYZus{}beta\PYZus{}model}\PY{p}{,}
        \PY{n}{k\PYZus{}gamma\PYZus{}model}\PY{p}{,}
        \PY{n}{E\PYZus{}profit\PYZus{}model}\PY{p}{]}
    \PY{p}{)}

\PY{n}{parameters\PYZus{}to\PYZus{}fit} \PY{o}{=} \PY{n}{nn}\PY{o}{.}\PY{n}{Parameter}\PY{p}{(}\PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{)}



\PY{k}{def} \PY{n+nf}{run\PYZus{}simulation}\PY{p}{(}\PY{n}{cluster\PYZus{}index}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{)}\PY{p}{:}
    
    \PY{n}{edge\PYZus{}props\PYZus{}this\PYZus{}cluster} \PY{o}{=} \PY{n}{edge\PYZus{}properties}\PY{p}{[}\PY{n}{cluster\PYZus{}index}\PY{p}{]}
    \PY{n}{num\PYZus{}agents\PYZus{}in\PYZus{}cluster} \PY{o}{=} \PY{n}{cluster\PYZus{}size}\PY{p}{[}\PY{n}{cluster\PYZus{}index}\PY{p}{]}
    

    
    \PY{c+c1}{\PYZsh{} initialise clusters and agents}
    \PY{n}{initial\PYZus{}opinion} \PY{o}{=} \PY{n}{get\PYZus{}initial\PYZus{}opinions}\PY{p}{(}\PY{n}{cluster\PYZus{}index}\PY{p}{)}
    
    
    \PY{c+c1}{\PYZsh{} initialise driving force}
    \PY{n}{driving\PYZus{}forces} \PY{o}{=} \PY{n}{update\PYZus{}driving\PYZus{}forces\PYZus{}cluster\PYZus{}specific}\PY{p}{(}\PY{n}{edge\PYZus{}props\PYZus{}this\PYZus{}cluster}\PY{p}{,} \PY{n}{cluster\PYZus{}index}\PY{p}{,} \PY{n}{initial\PYZus{}opinion}\PY{p}{)}
    \PY{n}{driving\PYZus{}forces} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{tensor}\PY{p}{(}\PY{n}{driving\PYZus{}forces}\PY{p}{)}
    
    \PY{n}{distribution} \PY{o}{=} \PY{n}{SimpleFCNet}\PY{p}{(}
    \PY{n}{num\PYZus{}layers}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}
    \PY{n}{in\PYZus{}dim}\PY{o}{=}\PY{n}{num\PYZus{}agents\PYZus{}in\PYZus{}cluster}\PY{o}{+}\PY{l+m+mi}{4}\PY{p}{,}
    \PY{n}{out\PYZus{}dim}\PY{o}{=}\PY{n}{num\PYZus{}agents\PYZus{}in\PYZus{}cluster}\PY{p}{,}
    \PY{n}{hidden\PYZus{}dim}\PY{o}{=}\PY{l+m+mi}{2}\PY{o}{*}\PY{p}{(}\PY{n}{num\PYZus{}agents\PYZus{}in\PYZus{}cluster}\PY{p}{)}
    \PY{p}{)}
    

    \PY{n}{all\PYZus{}opinions} \PY{o}{=} \PY{p}{[}\PY{p}{]}
    \PY{n}{all\PYZus{}opinions}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{initial\PYZus{}opinion}\PY{p}{)}
    
    \PY{k}{for} \PY{n}{step} \PY{o+ow}{in} \PY{n}{tqdm}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{25}\PY{p}{)}\PY{p}{,} \PY{n}{desc}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{simulation step }\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:}
        \PY{n}{y} \PY{o}{=} \PY{n}{opinion\PYZus{}timeline\PYZus{}agents}\PY{p}{[}\PY{n}{cluster\PYZus{}range}\PY{p}{[}\PY{n}{cluster\PYZus{}index}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{:}\PY{n}{cluster\PYZus{}range}\PY{p}{[}\PY{n}{cluster\PYZus{}index}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,}\PY{n}{step}\PY{p}{]}
        \PY{n}{y} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{tensor}\PY{p}{(}\PY{n}{y}\PY{p}{)}
        \PY{n}{x} \PY{o}{=} \PY{p}{[}\PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{,} \PY{n}{driving\PYZus{}forces}\PY{p}{]}
        \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{,} \PY{n}{new\PYZus{}opinion} \PY{o}{=} \PY{n}{train}\PY{p}{(}\PY{n}{distribution}\PY{p}{,} \PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{step}\PY{p}{,} \PY{n}{all\PYZus{}opinions}\PY{p}{)}
        \PY{n}{all\PYZus{}opinions}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{new\PYZus{}opinion}\PY{p}{)}

        \PY{n}{driving\PYZus{}forces} \PY{o}{=} \PY{n}{update\PYZus{}driving\PYZus{}forces\PYZus{}model}\PY{p}{(}\PY{n}{new\PYZus{}opinion}\PY{p}{,} \PY{n}{driving\PYZus{}forces}\PY{p}{,} \PY{n}{edge\PYZus{}props\PYZus{}this\PYZus{}cluster}\PY{p}{,} \PY{n}{cluster\PYZus{}index}\PY{p}{,} 
                                                   \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{float}\PY{p}{(}\PY{p}{)}\PY{p}{,}
                                                   \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{float}\PY{p}{(}\PY{p}{)}\PY{p}{,}
                                                   \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{float}\PY{p}{(}\PY{p}{)}\PY{p}{,} 
                                                   \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{o}{.}\PY{n}{float}\PY{p}{(}\PY{p}{)}\PY{p}{)}
        \PY{n}{driving\PYZus{}forces} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{tensor}\PY{p}{(}\PY{n}{driving\PYZus{}forces}\PY{p}{)}
        
    \PY{c+c1}{\PYZsh{}plot(all\PYZus{}opinions, cluster\PYZus{}index)}
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{with-return}{%
\section{With return:}\label{with-return}}

    \hypertarget{train-peoria-get-parameters-predicte-other-clusters}{%
\section{\texorpdfstring{\textbf{train Peoria, get parameters, predicte
other
clusters}}{train Peoria, get parameters, predicte other clusters}}\label{train-peoria-get-parameters-predicte-other-clusters}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{79}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{run\PYZus{}simulation}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{)}
\PY{n}{get\PYZus{}change\PYZus{}simulated}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}
\PY{n}{get\PYZus{}change\PYZus{}simulated}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}
\PY{n}{get\PYZus{}change\PYZus{}simulated}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}
\PY{n}{get\PYZus{}change\PYZus{}simulated}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
simulation step :   0\%|          | 0/25 [00:00<?, ?it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 541.55it/s]
simulation step :   4\%|▍         | 1/25 [00:00<00:02,  8.95it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 653.71it/s]

training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 451.69it/s]
simulation step :  12\%|█▏        | 3/25 [00:00<00:02,  8.85it/s]
training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 493.04it/s]
simulation step :  16\%|█▌        | 4/25 [00:00<00:02,  8.64it/s]
training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 464.91it/s]
simulation step :  20\%|██        | 5/25 [00:00<00:02,  8.36it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 500.12it/s]
simulation step :  24\%|██▍       | 6/25 [00:00<00:02,  8.35it/s]
training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 467.77it/s]
simulation step :  28\%|██▊       | 7/25 [00:00<00:02,  8.20it/s]
training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 492.33it/s]
simulation step :  32\%|███▏      | 8/25 [00:00<00:02,  8.20it/s]
training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 477.89it/s]
simulation step :  36\%|███▌      | 9/25 [00:01<00:01,  8.16it/s]
training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 492.58it/s]
simulation step :  40\%|████      | 10/25 [00:01<00:01,  8.16it/s]
training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 465.27it/s]
simulation step :  44\%|████▍     | 11/25 [00:01<00:01,  8.06it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 501.52it/s]
simulation step :  48\%|████▊     | 12/25 [00:01<00:01,  8.18it/s]
training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 487.18it/s]
simulation step :  52\%|█████▏    | 13/25 [00:01<00:01,  8.17it/s]
training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 490.80it/s]
simulation step :  56\%|█████▌    | 14/25 [00:01<00:01,  8.19it/s]
training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 472.72it/s]
simulation step :  60\%|██████    | 15/25 [00:01<00:01,  8.12it/s]
training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 463.29it/s]
simulation step :  64\%|██████▍   | 16/25 [00:01<00:01,  8.02it/s]
training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 468.57it/s]
simulation step :  68\%|██████▊   | 17/25 [00:02<00:01,  7.98it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 503.40it/s]
simulation step :  72\%|███████▏  | 18/25 [00:02<00:00,  8.13it/s]
training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 475.43it/s]
simulation step :  76\%|███████▌  | 19/25 [00:02<00:00,  8.10it/s]
training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 495.46it/s]
simulation step :  80\%|████████  | 20/25 [00:02<00:00,  8.13it/s]
training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 461.42it/s]
simulation step :  84\%|████████▍ | 21/25 [00:02<00:00,  8.04it/s]
training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 464.90it/s]
simulation step :  88\%|████████▊ | 22/25 [00:02<00:00,  7.98it/s]
training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 486.94it/s]
simulation step :  92\%|█████████▏| 23/25 [00:02<00:00,  8.03it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 503.21it/s]
simulation step :  96\%|█████████▌| 24/25 [00:02<00:00,  8.15it/s]
training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 501.68it/s]
simulation step : 100\%|██████████| 25/25 [00:03<00:00,  8.19it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
cluster  0
    time unit  percentage
0           0    0.017241
1           1    0.043103
2           2    0.051724
3           3    0.112069
4           4    0.129310
5           5    0.120690
6           6    0.120690
7           7    0.146552
8           8    0.181034
9           9    0.215517
10         10    0.250000
11         11    0.284483
12         12    0.284483
13         13    0.293103
14         14    0.284483
15         15    0.327586
16         16    0.327586
17         17    0.353448
18         18    0.353448
19         19    0.370690
20         20    0.370690
21         21    0.379310
22         22    0.379310
23         23    0.379310
24         24    0.396552

cluster  1
    time unit  percentage
0           0        0.10
1           1        0.10
2           2        0.12
3           3        0.12
4           4        0.16
5           5        0.18
6           6        0.16
7           7        0.16
8           8        0.22
9           9        0.24
10         10        0.26
11         11        0.26
12         12        0.26
13         13        0.30
14         14        0.32
15         15        0.34
16         16        0.40
17         17        0.38
18         18        0.36
19         19        0.42
20         20        0.38
21         21        0.38
22         22        0.38
23         23        0.36
24         24        0.38

cluster  2
    time unit  percentage
0           0    0.045455
1           1    0.090909
2           2    0.136364
3           3    0.159091
4           4    0.159091
5           5    0.181818
6           6    0.272727
7           7    0.340909
8           8    0.295455
9           9    0.318182
10         10    0.340909
11         11    0.295455
12         12    0.295455
13         13    0.318182
14         14    0.340909
15         15    0.409091
16         16    0.386364
17         17    0.454545
18         18    0.431818
19         19    0.454545
20         20    0.454545
21         21    0.409091
22         22    0.454545
23         23    0.500000
24         24    0.477273

cluster  3
    time unit  percentage
0           0    0.055556
1           1    0.083333
2           2    0.194444
3           3    0.277778
4           4    0.277778
5           5    0.305556
6           6    0.333333
7           7    0.388889
8           8    0.416667
9           9    0.416667
10         10    0.388889
11         11    0.388889
12         12    0.416667
13         13    0.388889
14         14    0.333333
15         15    0.333333
16         16    0.333333
17         17    0.333333
18         18    0.333333
19         19    0.305556
20         20    0.305556
21         21    0.250000
22         22    0.222222
23         23    0.277778
24         24    0.361111

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_23_26.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{train-bloomington-get-parameters-predicte-other-clusters}{%
\section{\texorpdfstring{\textbf{train Bloomington, get parameters,
predicte other
clusters}}{train Bloomington, get parameters, predicte other clusters}}\label{train-bloomington-get-parameters-predicte-other-clusters}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{80}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{run\PYZus{}simulation}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{)}
\PY{n}{get\PYZus{}change\PYZus{}simulated}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}
\PY{n}{get\PYZus{}change\PYZus{}simulated}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}
\PY{n}{get\PYZus{}change\PYZus{}simulated}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}
\PY{n}{get\PYZus{}change\PYZus{}simulated}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
simulation step :   0\%|          | 0/25 [00:00<?, ?it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1266.59it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1369.23it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1052.98it/s]
simulation step :  12\%|█▏        | 3/25 [00:00<00:01, 20.21it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1041.76it/s]

training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
None
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1020.89it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1021.64it/s]
simulation step :  24\%|██▍       | 6/25 [00:00<00:01, 18.45it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1001.91it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1013.95it/s]
simulation step :  32\%|███▏      | 8/25 [00:00<00:00, 17.97it/s]
training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
None
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 990.32it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1034.75it/s]
simulation step :  40\%|████      | 10/25 [00:00<00:00, 17.68it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1027.85it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1038.40it/s]
simulation step :  48\%|████▊     | 12/25 [00:00<00:00, 17.66it/s]
training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
None
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 971.85it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1037.09it/s]
simulation step :  56\%|█████▌    | 14/25 [00:00<00:00, 17.52it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1039.07it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1000.42it/s]
simulation step :  64\%|██████▍   | 16/25 [00:00<00:00, 17.47it/s]
training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
None
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 931.48it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 973.64it/s]
simulation step :  72\%|███████▏  | 18/25 [00:01<00:00, 17.09it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 978.34it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1012.00it/s]
simulation step :  80\%|████████  | 20/25 [00:01<00:00, 17.05it/s]
training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
None
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 971.16it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1013.67it/s]
simulation step :  88\%|████████▊ | 22/25 [00:01<00:00, 17.02it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1002.95it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1018.44it/s]
simulation step :  96\%|█████████▌| 24/25 [00:01<00:00, 17.07it/s]
training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
None
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 966.35it/s]
simulation step : 100\%|██████████| 25/25 [00:01<00:00, 17.42it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
cluster  0
    time unit  percentage
0           0    0.017241
1           1    0.043103
2           2    0.043103
3           3    0.077586
4           4    0.086207
5           5    0.103448
6           6    0.112069
7           7    0.137931
8           8    0.198276
9           9    0.206897
10         10    0.215517
11         11    0.206897
12         12    0.215517
13         13    0.250000
14         14    0.267241
15         15    0.267241
16         16    0.301724
17         17    0.284483
18         18    0.310345
19         19    0.362069
20         20    0.370690
21         21    0.396552
22         22    0.413793
23         23    0.396552
24         24    0.379310

cluster  1
    time unit  percentage
0           0        0.10
1           1        0.16
2           2        0.16
3           3        0.16
4           4        0.20
5           5        0.28
6           6        0.34
7           7        0.34
8           8        0.40
9           9        0.38
10         10        0.40
11         11        0.46
12         12        0.46
13         13        0.48
14         14        0.50
15         15        0.46
16         16        0.46
17         17        0.46
18         18        0.50
19         19        0.54
20         20        0.52
21         21        0.48
22         22        0.48
23         23        0.48
24         24        0.46

cluster  2
    time unit  percentage
0           0    0.045455
1           1    0.045455
2           2    0.090909
3           3    0.090909
4           4    0.113636
5           5    0.136364
6           6    0.181818
7           7    0.181818
8           8    0.181818
9           9    0.181818
10         10    0.181818
11         11    0.227273
12         12    0.227273
13         13    0.204545
14         14    0.227273
15         15    0.272727
16         16    0.318182
17         17    0.363636
18         18    0.340909
19         19    0.386364
20         20    0.386364
21         21    0.386364
22         22    0.363636
23         23    0.386364
24         24    0.409091

cluster  3
    time unit  percentage
0           0    0.055556
1           1    0.027778
2           2    0.027778
3           3    0.027778
4           4    0.083333
5           5    0.111111
6           6    0.138889
7           7    0.138889
8           8    0.083333
9           9    0.111111
10         10    0.138889
11         11    0.166667
12         12    0.166667
13         13    0.194444
14         14    0.250000
15         15    0.250000
16         16    0.250000
17         17    0.305556
18         18    0.333333
19         19    0.361111
20         20    0.361111
21         21    0.361111
22         22    0.333333
23         23    0.388889
24         24    0.416667

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_25_14.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{train-quincy-get-parameters-predicte-other-clusters}{%
\section{\texorpdfstring{\textbf{train Quincy, get parameters, predicte
other
clusters}}{train Quincy, get parameters, predicte other clusters}}\label{train-quincy-get-parameters-predicte-other-clusters}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{81}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{run\PYZus{}simulation}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{)}
\PY{n}{get\PYZus{}change\PYZus{}simulated}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}
\PY{n}{get\PYZus{}change\PYZus{}simulated}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}
\PY{n}{get\PYZus{}change\PYZus{}simulated}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}
\PY{n}{get\PYZus{}change\PYZus{}simulated}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
simulation step :   0\%|          | 0/25 [00:00<?, ?it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1451.77it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1476.63it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1102.27it/s]
simulation step :  12\%|█▏        | 3/25 [00:00<00:00, 22.18it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1132.50it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1131.07it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
None
None
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1116.10it/s]
simulation step :  24\%|██▍       | 6/25 [00:00<00:00, 20.31it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1146.39it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1140.48it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1123.09it/s]
simulation step :  36\%|███▌      | 9/25 [00:00<00:00, 19.92it/s]
training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
None
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1128.85it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1125.76it/s]
simulation step :  44\%|████▍     | 11/25 [00:00<00:00, 19.70it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1142.26it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1127.95it/s]
simulation step :  52\%|█████▏    | 13/25 [00:00<00:00, 19.61it/s]
training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
None
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1121.61it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1125.63it/s]
simulation step :  60\%|██████    | 15/25 [00:00<00:00, 19.44it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1139.99it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1129.23it/s]
simulation step :  68\%|██████▊   | 17/25 [00:00<00:00, 19.45it/s]
training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
None
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1064.51it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1097.99it/s]
simulation step :  76\%|███████▌  | 19/25 [00:00<00:00, 19.19it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1084.67it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1095.31it/s]
simulation step :  84\%|████████▍ | 21/25 [00:01<00:00, 19.05it/s]
training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
None
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1071.40it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1051.26it/s]
simulation step :  92\%|█████████▏| 23/25 [00:01<00:00, 18.76it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1098.24it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1111.85it/s]
simulation step : 100\%|██████████| 25/25 [00:01<00:00, 19.37it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
None
None
cluster  0
    time unit  percentage
0           0    0.017241
1           1    0.068966
2           2    0.077586
3           3    0.112069
4           4    0.137931
5           5    0.155172
6           6    0.172414
7           7    0.181034
8           8    0.198276
9           9    0.232759
10         10    0.250000
11         11    0.267241
12         12    0.250000
13         13    0.267241
14         14    0.284483
15         15    0.310345
16         16    0.318966
17         17    0.362069
18         18    0.370690
19         19    0.413793
20         20    0.405172
21         21    0.422414
22         22    0.396552
23         23    0.405172
24         24    0.387931

cluster  1
    time unit  percentage
0           0        0.10
1           1        0.12
2           2        0.16
3           3        0.18
4           4        0.20
5           5        0.20
6           6        0.22
7           7        0.24
8           8        0.22
9           9        0.28
10         10        0.32
11         11        0.28
12         12        0.32
13         13        0.34
14         14        0.34
15         15        0.40
16         16        0.40
17         17        0.42
18         18        0.42
19         19        0.46
20         20        0.46
21         21        0.44
22         22        0.44
23         23        0.46
24         24        0.50

cluster  2
    time unit  percentage
0           0    0.045455
1           1    0.068182
2           2    0.068182
3           3    0.136364
4           4    0.204545
5           5    0.204545
6           6    0.204545
7           7    0.227273
8           8    0.250000
9           9    0.272727
10         10    0.272727
11         11    0.272727
12         12    0.318182
13         13    0.340909
14         14    0.386364
15         15    0.500000
16         16    0.500000
17         17    0.500000
18         18    0.545455
19         19    0.590909
20         20    0.545455
21         21    0.522727
22         22    0.477273
23         23    0.454545
24         24    0.477273

cluster  3
    time unit  percentage
0           0    0.055556
1           1    0.083333
2           2    0.111111
3           3    0.138889
4           4    0.166667
5           5    0.277778
6           6    0.361111
7           7    0.361111
8           8    0.388889
9           9    0.388889
10         10    0.388889
11         11    0.388889
12         12    0.361111
13         13    0.416667
14         14    0.444444
15         15    0.472222
16         16    0.472222
17         17    0.472222
18         18    0.472222
19         19    0.472222
20         20    0.500000
21         21    0.527778
22         22    0.555556
23         23    0.500000
24         24    0.472222

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_27_12.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{train-galesburg-get-parameters-predicte-other-clusters}{%
\section{\texorpdfstring{\textbf{train Galesburg, get parameters,
predicte other
clusters}}{train Galesburg, get parameters, predicte other clusters}}\label{train-galesburg-get-parameters-predicte-other-clusters}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{82}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{run\PYZus{}simulation}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{)}
\PY{n}{get\PYZus{}change\PYZus{}simulated}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}
\PY{n}{get\PYZus{}change\PYZus{}simulated}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}
\PY{n}{get\PYZus{}change\PYZus{}simulated}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}
\PY{n}{get\PYZus{}change\PYZus{}simulated}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
simulation step :   0\%|          | 0/25 [00:00<?, ?it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1693.19it/s]

training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1644.09it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1285.55it/s]
simulation step :  12\%|█▏        | 3/25 [00:00<00:00, 24.85it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1287.28it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1342.43it/s]

training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
None
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1262.50it/s]
simulation step :  24\%|██▍       | 6/25 [00:00<00:00, 23.02it/s]
training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1270.23it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1298.29it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1321.67it/s]
simulation step :  36\%|███▌      | 9/25 [00:00<00:00, 22.50it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1315.37it/s]

training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
None
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1302.43it/s]

training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1276.16it/s]
simulation step :  48\%|████▊     | 12/25 [00:00<00:00, 22.26it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1298.54it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1295.50it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1296.00it/s]
simulation step :  60\%|██████    | 15/25 [00:00<00:00, 22.07it/s]
training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
None
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1254.14it/s]

training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1257.65it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1309.07it/s]
simulation step :  72\%|███████▏  | 18/25 [00:00<00:00, 21.87it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1291.72it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1320.28it/s]

training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
None
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1264.89it/s]
simulation step :  84\%|████████▍ | 21/25 [00:00<00:00, 21.83it/s]
training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1258.21it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1322.99it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1318.26it/s]
simulation step :  96\%|█████████▌| 24/25 [00:01<00:00, 21.82it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1288.36it/s]
simulation step : 100\%|██████████| 25/25 [00:01<00:00, 22.11it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
None
None
cluster  0
    time unit  percentage
0           0    0.017241
1           1    0.034483
2           2    0.051724
3           3    0.077586
4           4    0.086207
5           5    0.103448
6           6    0.112069
7           7    0.146552
8           8    0.163793
9           9    0.198276
10         10    0.215517
11         11    0.250000
12         12    0.258621
13         13    0.250000
14         14    0.301724
15         15    0.293103
16         16    0.327586
17         17    0.344828
18         18    0.353448
19         19    0.362069
20         20    0.379310
21         21    0.396552
22         22    0.405172
23         23    0.405172
24         24    0.422414

cluster  1
    time unit  percentage
0           0        0.10
1           1        0.14
2           2        0.14
3           3        0.12
4           4        0.16
5           5        0.22
6           6        0.24
7           7        0.24
8           8        0.28
9           9        0.28
10         10        0.32
11         11        0.36
12         12        0.42
13         13        0.38
14         14        0.42
15         15        0.40
16         16        0.40
17         17        0.40
18         18        0.42
19         19        0.46
20         20        0.46
21         21        0.42
22         22        0.40
23         23        0.40
24         24        0.38

cluster  2
    time unit  percentage
0           0    0.045455
1           1    0.090909
2           2    0.113636
3           3    0.113636
4           4    0.113636
5           5    0.159091
6           6    0.181818
7           7    0.181818
8           8    0.204545
9           9    0.204545
10         10    0.204545
11         11    0.272727
12         12    0.272727
13         13    0.272727
14         14    0.295455
15         15    0.295455
16         16    0.272727
17         17    0.272727
18         18    0.295455
19         19    0.340909
20         20    0.431818
21         21    0.454545
22         22    0.431818
23         23    0.500000
24         24    0.545455

cluster  3
    time unit  percentage
0           0    0.055556
1           1    0.111111
2           2    0.138889
3           3    0.194444
4           4    0.361111
5           5    0.361111
6           6    0.444444
7           7    0.472222
8           8    0.472222
9           9    0.527778
10         10    0.527778
11         11    0.500000
12         12    0.472222
13         13    0.388889
14         14    0.388889
15         15    0.472222
16         16    0.444444
17         17    0.444444
18         18    0.416667
19         19    0.416667
20         20    0.416667
21         21    0.388889
22         22    0.361111
23         23    0.416667
24         24    0.388889

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_29_20.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{no-return-allowed}{%
\section{no return allowed:}\label{no-return-allowed}}

    \hypertarget{train-peoria-get-parameters-predicte-other-clusters}{%
\section{\texorpdfstring{\textbf{train Peoria, get parameters, predicte
other
clusters}}{train Peoria, get parameters, predicte other clusters}}\label{train-peoria-get-parameters-predicte-other-clusters}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{88}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{run\PYZus{}simulation}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{)}
\PY{n}{get\PYZus{}change\PYZus{}simulated}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}
\PY{n}{get\PYZus{}change\PYZus{}simulated}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}
\PY{n}{get\PYZus{}change\PYZus{}simulated}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}
\PY{n}{get\PYZus{}change\PYZus{}simulated}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
simulation step :   0\%|          | 0/25 [00:00<?, ?it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 529.46it/s]
simulation step :   4\%|▍         | 1/25 [00:00<00:02,  8.74it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 698.50it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 557.36it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
simulation step :  12\%|█▏        | 3/25 [00:00<00:02,  9.67it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 529.01it/s]
simulation step :  16\%|█▌        | 4/25 [00:00<00:02,  9.38it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 650.03it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 646.95it/s]
simulation step :  24\%|██▍       | 6/25 [00:00<00:01, 10.09it/s]
training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 729.88it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 744.52it/s]
simulation step :  32\%|███▏      | 8/25 [00:00<00:01, 10.94it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 789.20it/s]

training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 774.20it/s]
simulation step :  40\%|████      | 10/25 [00:00<00:01, 11.67it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 797.75it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 826.70it/s]
simulation step :  48\%|████▊     | 12/25 [00:01<00:01, 12.31it/s]
training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 801.85it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 835.48it/s]
simulation step :  56\%|█████▌    | 14/25 [00:01<00:00, 12.75it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 839.20it/s]

training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 794.49it/s]
simulation step :  64\%|██████▍   | 16/25 [00:01<00:00, 13.07it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 793.03it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 814.50it/s]
simulation step :  72\%|███████▏  | 18/25 [00:01<00:00, 13.19it/s]
training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 800.42it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 840.32it/s]
simulation step :  80\%|████████  | 20/25 [00:01<00:00, 13.44it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 832.14it/s]

training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 830.72it/s]
simulation step :  88\%|████████▊ | 22/25 [00:01<00:00, 13.66it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 824.36it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 848.26it/s]
simulation step :  96\%|█████████▌| 24/25 [00:01<00:00, 13.83it/s]
training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 825.00it/s]
simulation step : 100\%|██████████| 25/25 [00:02<00:00, 12.48it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
cluster  0
    time unit  percentage
0           0    0.017241
1           1    0.034483
2           2    0.051724
3           3    0.077586
4           4    0.112069
5           5    0.137931
6           6    0.172414
7           7    0.206897
8           8    0.224138
9           9    0.241379
10         10    0.258621
11         11    0.275862
12         12    0.327586
13         13    0.353448
14         14    0.387931
15         15    0.387931
16         16    0.387931
17         17    0.405172
18         18    0.413793
19         19    0.439655
20         20    0.465517
21         21    0.491379
22         22    0.543103
23         23    0.560345
24         24    0.568966

cluster  1
    time unit  percentage
0           0        0.10
1           1        0.18
2           2        0.22
3           3        0.22
4           4        0.28
5           5        0.32
6           6        0.34
7           7        0.36
8           8        0.36
9           9        0.36
10         10        0.40
11         11        0.42
12         12        0.50
13         13        0.54
14         14        0.54
15         15        0.54
16         16        0.56
17         17        0.58
18         18        0.62
19         19        0.64
20         20        0.70
21         21        0.70
22         22        0.72
23         23        0.72
24         24        0.74

cluster  2
    time unit  percentage
0           0    0.045455
1           1    0.068182
2           2    0.113636
3           3    0.136364
4           4    0.136364
5           5    0.159091
6           6    0.181818
7           7    0.181818
8           8    0.204545
9           9    0.227273
10         10    0.272727
11         11    0.318182
12         12    0.340909
13         13    0.386364
14         14    0.409091
15         15    0.454545
16         16    0.477273
17         17    0.500000
18         18    0.522727
19         19    0.522727
20         20    0.522727
21         21    0.522727
22         22    0.522727
23         23    0.522727
24         24    0.522727

cluster  3
    time unit  percentage
0           0    0.055556
1           1    0.111111
2           2    0.111111
3           3    0.194444
4           4    0.222222
5           5    0.222222
6           6    0.250000
7           7    0.277778
8           8    0.277778
9           9    0.305556
10         10    0.333333
11         11    0.388889
12         12    0.388889
13         13    0.444444
14         14    0.472222
15         15    0.500000
16         16    0.555556
17         17    0.583333
18         18    0.611111
19         19    0.694444
20         20    0.722222
21         21    0.750000
22         22    0.777778
23         23    0.805556
24         24    0.805556

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_32_18.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{train-bloomington-get-parameters-predicte-other-clusters}{%
\section{\texorpdfstring{\textbf{train Bloomington, get parameters,
predicte other
clusters}}{train Bloomington, get parameters, predicte other clusters}}\label{train-bloomington-get-parameters-predicte-other-clusters}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{89}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{run\PYZus{}simulation}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{)}
\PY{n}{get\PYZus{}change\PYZus{}simulated}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}
\PY{n}{get\PYZus{}change\PYZus{}simulated}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}
\PY{n}{get\PYZus{}change\PYZus{}simulated}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}
\PY{n}{get\PYZus{}change\PYZus{}simulated}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
simulation step :   0\%|          | 0/25 [00:00<?, ?it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 930.11it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1410.24it/s]
simulation step :   8\%|▊         | 2/25 [00:00<00:01, 18.57it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1122.79it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1134.33it/s]
simulation step :  16\%|█▌        | 4/25 [00:00<00:01, 19.06it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1375.60it/s]

training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
None
None
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1403.90it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1521.84it/s]
simulation step :  28\%|██▊       | 7/25 [00:00<00:00, 21.55it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1492.76it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1525.36it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1558.69it/s]
simulation step :  40\%|████      | 10/25 [00:00<00:00, 23.18it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1556.07it/s]

training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
None
None
None
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1516.03it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1611.93it/s]
simulation step :  52\%|█████▏    | 13/25 [00:00<00:00, 24.34it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1566.71it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1616.83it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1574.80it/s]
simulation step :  64\%|██████▍   | 16/25 [00:00<00:00, 25.14it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1555.74it/s]

training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
None
None
None
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1488.19it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1518.70it/s]
simulation step :  76\%|███████▌  | 19/25 [00:00<00:00, 25.33it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1527.03it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1548.80it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1569.67it/s]
simulation step :  88\%|████████▊ | 22/25 [00:00<00:00, 25.72it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1566.41it/s]

training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
None
None
None
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1560.56it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1563.09it/s]
simulation step : 100\%|██████████| 25/25 [00:01<00:00, 24.50it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
cluster  0
    time unit  percentage
0           0    0.017241
1           1    0.051724
2           2    0.086207
3           3    0.112069
4           4    0.146552
5           5    0.172414
6           6    0.189655
7           7    0.224138
8           8    0.267241
9           9    0.293103
10         10    0.327586
11         11    0.336207
12         12    0.362069
13         13    0.387931
14         14    0.413793
15         15    0.422414
16         16    0.448276
17         17    0.482759
18         18    0.500000
19         19    0.534483
20         20    0.543103
21         21    0.568966
22         22    0.568966
23         23    0.586207
24         24    0.594828

cluster  1
    time unit  percentage
0           0        0.10
1           1        0.12
2           2        0.16
3           3        0.20
4           4        0.22
5           5        0.24
6           6        0.30
7           7        0.34
8           8        0.38
9           9        0.38
10         10        0.40
11         11        0.44
12         12        0.46
13         13        0.48
14         14        0.52
15         15        0.52
16         16        0.56
17         17        0.60
18         18        0.60
19         19        0.62
20         20        0.62
21         21        0.62
22         22        0.64
23         23        0.68
24         24        0.70

cluster  2
    time unit  percentage
0           0    0.045455
1           1    0.045455
2           2    0.045455
3           3    0.045455
4           4    0.113636
5           5    0.136364
6           6    0.181818
7           7    0.227273
8           8    0.250000
9           9    0.250000
10         10    0.272727
11         11    0.363636
12         12    0.386364
13         13    0.386364
14         14    0.386364
15         15    0.454545
16         16    0.454545
17         17    0.500000
18         18    0.522727
19         19    0.522727
20         20    0.522727
21         21    0.522727
22         22    0.545455
23         23    0.545455
24         24    0.545455

cluster  3
    time unit  percentage
0           0    0.055556
1           1    0.083333
2           2    0.166667
3           3    0.194444
4           4    0.222222
5           5    0.277778
6           6    0.277778
7           7    0.305556
8           8    0.361111
9           9    0.388889
10         10    0.444444
11         11    0.472222
12         12    0.500000
13         13    0.500000
14         14    0.583333
15         15    0.611111
16         16    0.666667
17         17    0.666667
18         18    0.694444
19         19    0.694444
20         20    0.722222
21         21    0.722222
22         22    0.722222
23         23    0.722222
24         24    0.722222

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_34_10.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{train-quincy-get-parameters-predicte-other-clusters}{%
\section{\texorpdfstring{\textbf{train Quincy, get parameters, predicte
other
clusters}}{train Quincy, get parameters, predicte other clusters}}\label{train-quincy-get-parameters-predicte-other-clusters}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{90}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{run\PYZus{}simulation}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{)}
\PY{n}{get\PYZus{}change\PYZus{}simulated}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}
\PY{n}{get\PYZus{}change\PYZus{}simulated}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}
\PY{n}{get\PYZus{}change\PYZus{}simulated}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}
\PY{n}{get\PYZus{}change\PYZus{}simulated}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
simulation step :   0\%|          | 0/25 [00:00<?, ?it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 939.00it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1444.13it/s]
simulation step :   8\%|▊         | 2/25 [00:00<00:01, 18.86it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1360.35it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1201.92it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1577.78it/s]
simulation step :  20\%|██        | 5/25 [00:00<00:00, 21.68it/s]
training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
None
None
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1395.56it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1675.50it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1587.61it/s]
simulation step :  32\%|███▏      | 8/25 [00:00<00:00, 23.83it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1784.13it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1724.96it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1805.26it/s]

training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
None
None
None
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1751.63it/s]
simulation step :  48\%|████▊     | 12/25 [00:00<00:00, 26.58it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1754.40it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1778.91it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1786.47it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1789.50it/s]
simulation step :  64\%|██████▍   | 16/25 [00:00<00:00, 27.94it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1751.55it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1737.85it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
None
None
None
None
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1724.92it/s]
simulation step :  76\%|███████▌  | 19/25 [00:00<00:00, 28.41it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1725.70it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1754.76it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1738.17it/s]
simulation step :  88\%|████████▊ | 22/25 [00:00<00:00, 28.74it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1721.64it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1699.59it/s]

training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
None
None
None
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1661.74it/s]
simulation step : 100\%|██████████| 25/25 [00:00<00:00, 27.11it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
cluster  0
    time unit  percentage
0           0    0.017241
1           1    0.051724
2           2    0.086207
3           3    0.094828
4           4    0.103448
5           5    0.146552
6           6    0.146552
7           7    0.172414
8           8    0.206897
9           9    0.258621
10         10    0.293103
11         11    0.327586
12         12    0.336207
13         13    0.379310
14         14    0.387931
15         15    0.396552
16         16    0.422414
17         17    0.439655
18         18    0.465517
19         19    0.465517
20         20    0.482759
21         21    0.500000
22         22    0.500000
23         23    0.517241
24         24    0.551724

cluster  1
    time unit  percentage
0           0        0.10
1           1        0.16
2           2        0.18
3           3        0.18
4           4        0.18
5           5        0.20
6           6        0.26
7           7        0.30
8           8        0.30
9           9        0.30
10         10        0.36
11         11        0.42
12         12        0.44
13         13        0.44
14         14        0.46
15         15        0.48
16         16        0.48
17         17        0.48
18         18        0.52
19         19        0.56
20         20        0.62
21         21        0.62
22         22        0.62
23         23        0.62
24         24        0.62

cluster  2
    time unit  percentage
0           0    0.045455
1           1    0.045455
2           2    0.090909
3           3    0.090909
4           4    0.113636
5           5    0.113636
6           6    0.159091
7           7    0.159091
8           8    0.204545
9           9    0.250000
10         10    0.250000
11         11    0.272727
12         12    0.295455
13         13    0.363636
14         14    0.409091
15         15    0.409091
16         16    0.431818
17         17    0.500000
18         18    0.545455
19         19    0.568182
20         20    0.568182
21         21    0.568182
22         22    0.568182
23         23    0.636364
24         24    0.659091

cluster  3
    time unit  percentage
0           0    0.055556
1           1    0.083333
2           2    0.138889
3           3    0.166667
4           4    0.222222
5           5    0.250000
6           6    0.333333
7           7    0.388889
8           8    0.388889
9           9    0.388889
10         10    0.444444
11         11    0.472222
12         12    0.472222
13         13    0.500000
14         14    0.500000
15         15    0.527778
16         16    0.555556
17         17    0.555556
18         18    0.583333
19         19    0.583333
20         20    0.583333
21         21    0.583333
22         22    0.638889
23         23    0.694444
24         24    0.694444

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_36_10.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{train-galesburg-get-parameters-predicte-other-clusters}{%
\section{\texorpdfstring{\textbf{train Galesburg, get parameters,
predicte other
clusters}}{train Galesburg, get parameters, predicte other clusters}}\label{train-galesburg-get-parameters-predicte-other-clusters}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{91}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{run\PYZus{}simulation}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{)}
\PY{n}{get\PYZus{}change\PYZus{}simulated}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}
\PY{n}{get\PYZus{}change\PYZus{}simulated}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}
\PY{n}{get\PYZus{}change\PYZus{}simulated}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}
\PY{n}{get\PYZus{}change\PYZus{}simulated}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{parameters\PYZus{}to\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
simulation step :   0\%|          | 0/25 [00:00<?, ?it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1039.47it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1621.95it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1297.72it/s]
simulation step :  12\%|█▏        | 3/25 [00:00<00:01, 21.20it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1488.41it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1697.38it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1759.02it/s]
simulation step :  24\%|██▍       | 6/25 [00:00<00:00, 24.62it/s]
training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
None
None
None
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1840.14it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1925.88it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 2081.35it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 2044.39it/s]
simulation step :  40\%|████      | 10/25 [00:00<00:00, 28.59it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 2055.25it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 2050.02it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 2035.50it/s]

training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
None
None
None
None
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 2054.42it/s]
simulation step :  56\%|█████▌    | 14/25 [00:00<00:00, 30.95it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 2044.47it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 2077.01it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 2095.98it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 2112.66it/s]
simulation step :  72\%|███████▏  | 18/25 [00:00<00:00, 32.38it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1992.58it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1937.07it/s]

training model {\ldots}:   0\%|          | 0/50 [00:00<?, ?it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
None
None
None
None
None
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 1911.11it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 2087.61it/s]
simulation step :  88\%|████████▊ | 22/25 [00:00<00:00, 32.81it/s]
training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 2035.93it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 2021.02it/s]

training model {\ldots}: 100\%|██████████| 50/50 [00:00<00:00, 2042.42it/s]
simulation step : 100\%|██████████| 25/25 [00:00<00:00, 31.07it/s]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
None
None
None
None
None
cluster  0
    time unit  percentage
0           0    0.017241
1           1    0.068966
2           2    0.103448
3           3    0.137931
4           4    0.163793
5           5    0.206897
6           6    0.215517
7           7    0.232759
8           8    0.241379
9           9    0.258621
10         10    0.301724
11         11    0.327586
12         12    0.327586
13         13    0.353448
14         14    0.362069
15         15    0.370690
16         16    0.396552
17         17    0.422414
18         18    0.439655
19         19    0.474138
20         20    0.482759
21         21    0.491379
22         22    0.500000
23         23    0.534483
24         24    0.534483

cluster  1
    time unit  percentage
0           0        0.10
1           1        0.12
2           2        0.18
3           3        0.28
4           4        0.30
5           5        0.34
6           6        0.34
7           7        0.40
8           8        0.46
9           9        0.52
10         10        0.54
11         11        0.60
12         12        0.62
13         13        0.64
14         14        0.66
15         15        0.68
16         16        0.70
17         17        0.70
18         18        0.70
19         19        0.70
20         20        0.72
21         21        0.74
22         22        0.74
23         23        0.74
24         24        0.74

cluster  2
    time unit  percentage
0           0    0.045455
1           1    0.136364
2           2    0.181818
3           3    0.250000
4           4    0.295455
5           5    0.340909
6           6    0.340909
7           7    0.386364
8           8    0.454545
9           9    0.454545
10         10    0.477273
11         11    0.500000
12         12    0.500000
13         13    0.500000
14         14    0.568182
15         15    0.590909
16         16    0.590909
17         17    0.613636
18         18    0.636364
19         19    0.636364
20         20    0.636364
21         21    0.636364
22         22    0.636364
23         23    0.659091
24         24    0.659091

cluster  3
    time unit  percentage
0           0    0.055556
1           1    0.083333
2           2    0.194444
3           3    0.250000
4           4    0.277778
5           5    0.305556
6           6    0.305556
7           7    0.333333
8           8    0.361111
9           9    0.472222
10         10    0.472222
11         11    0.472222
12         12    0.500000
13         13    0.500000
14         14    0.527778
15         15    0.583333
16         16    0.611111
17         17    0.638889
18         18    0.638889
19         19    0.638889
20         20    0.638889
21         21    0.638889
22         22    0.638889
23         23    0.666667
24         24    0.666667

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_38_8.png}
    \end{center}
    { \hspace*{\fill} \\}
    

    % Add a bibliography block to the postdoc
    
    
    
\end{document}
